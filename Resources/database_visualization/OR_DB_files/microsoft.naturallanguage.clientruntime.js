try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.naturallanguage.clientruntime.js'] = (new Date()).getTime();
Type.registerNamespace("NLG");NLG.EmailData=function(){};NLG.inr=function(){};NLG.inr.registerInterface("NLG.inr");NLG.ts=function(a,b){this.$3_0=a;this.$A_0=b};NLG.ri=function(){};NLG.rem=function(a,f,g,b,c){this.$M_0=a;this.$R_0=f;this.$y_0=g;this.$G_0=b;this.$L_0=c;if(!c){this.$A_0=0;if(b<a.$9_0.length)this.$3_0=a.$9_0[b].$3_0;else if(a.$9_0.length>0)this.$3_0=a.$9_0[a.$9_0.length-1].$3_0+a.$9_0[a.$9_0.length-1].$A_0;else this.$3_0=0}else{var e=a.$9_0[b],d=a.$9_0[b+c-1];this.$3_0=e.$3_0;this.$A_0=d.$3_0+d.$A_0-this.$3_0}};NLG.cr=function(d,e,f,a,g){this.$q_0=d;this.$G_0=a.$G_0+e;this.$L_0=f;if(this.$L_0>0)this.$3_0=a.$M_0.$9_0[this.$G_0].$3_0;else if(this.$G_0===a.$M_0.$9_0.length)this.$3_0=!a.$M_0.$9_0.length?0:a.$M_0.$9_0[a.$M_0.$9_0.length-1].$3_0+a.$M_0.$9_0[a.$M_0.$9_0.length-1].$A_0;else this.$3_0=a.$M_0.$9_0[this.$G_0].$3_0;if(this.$L_0>0){var c=a.$M_0.$9_0[this.$G_0],b=a.$M_0.$9_0[this.$G_0+this.$L_0-1];this.$A_0=b.$3_0+b.$A_0-c.$3_0}else this.$A_0=0;this.$r_0=g};NLG.sim=function(a,b){if(!a)throw NLG.ex.$t("spans");if(null===b)throw NLG.ex.$t("parentString");this.$9_0=a;this.$1A_0=b};NLG.a=function(d,q){this.$N_0=d;var b=d.$5_0,a=b[q],i=b[a];++a;this.$2G_0=new Array(i);this.$2F_0=new Array(i);this.$1g_0=new Array(i);for(var e=0;e<i;++e){this.$2G_0[e]=d.$H_0(b[a]);++a;this.$2F_0[e]=b[a];++a;var p=b[a];++a;this.$1g_0[e]=new Array(p);for(var k=0;k<p;++k){this.$1g_0[e][k]=d.$H_0(b[a]);++a}}var h=b[a];++a;this.$2I_0=new Array(h);this.$1i_0=new Array(h);this.$1j_0=new Array(h);this.$1N_0=new Array(h);for(var c=0;c<h;++c){this.$2I_0[c]=d.$H_0(b[a]);++a;var j=b[a];++a;this.$1i_0[c]=new Array(j);this.$1j_0[c]=new Array(j);this.$1N_0[c]=new Array(j);for(var f=0;f<j;++f){this.$1i_0[c][f]=d.$H_0(b[a]);++a;this.$1j_0[c][f]=b[a];var l,m;this.$1N_0[c][f]=(m=this.$13_0(l={val:a}),a=l.val,m);NLG.a.$w(this.$1N_0[c][f])}}this.$Q_0=b[a];++a;this.$2C_0=new Array(this.$Q_0);this.$2D_0=new Array(this.$Q_0);this.$1e_0=new Array(this.$Q_0);for(var g=0;g<this.$Q_0;++g){this.$2C_0[g]=d.$H_0(b[a]);++a;this.$2D_0[g]=b[a];var n,o;this.$1e_0[g]=(o=this.$13_0(n={val:a}),a=n.val,o);NLG.a.$w(this.$1e_0[g])}};NLG.a.$1t=function(a){return (a&16383)>=16&&(a&16384)!==16384&&(a&32768)!==32768};NLG.a.$K=function(a){return (a&32768)===32768};NLG.a.$Z=function(a){if(!NLG.a.$K(a))throw NLG.ex.$8("listTypeID");return a&~32768};NLG.a.$2T=function(c,a,b){switch(c){case 1:return a===b;case 2:return a===b;case 3:return a===b;case 5:return a===b;case 9:return a.$1b_0(b);default:if(NLG.a.$K(c))return a.$1b_0(b);else if(NLG.a.$1t(c))return a===b;else return a.$1b_0(b)}};NLG.a.$w=function(a){if(NLG.fb.isInstanceOfType(a))a.$2B_0();else if(NLG.lv.isInstanceOfType(a))a.$2B_0();else NLG.sv.isInstanceOfType(a)&&a.$2B_0()};NLG.a.$2Z=function(a){return a-16};NLG.a.$1r=function(a){return (a&~16384)-16};NLG.a.prototype={$1W_0:function(b){for(var a=0;a<this.$Q_0;++a)if(this.$2C_0[a]===b)return a;return -1},$1Y_0:function(a){if(a<0||a>=this.$Q_0)throw NLG.ex.$8("attrID");return this.$2D_0[a]},$1Z_0:function(c,a){if(!this.$2A_0(c))throw NLG.ex.$8("structTypeID");var b=this.$1j_0[NLG.a.$1r(c)];if(a<0||a>=b.length)throw NLG.ex.$8("iField");return b[a]},$1H_0:function(c,a){if(null===a||a===undefined)return false;switch(c){case 1:return String.isInstanceOfType(a);case 2:return Boolean.isInstanceOfType(a);case 3:return Number.isInstanceOfType(a);case 5:return Number.isInstanceOfType(a);case 9:return NLG.fb.isInstanceOfType(a);default:if(NLG.a.$K(c)){var e=a;return !!e&&e.$i_0===NLG.a.$Z(c)}else if(NLG.a.$1t(c)){var b;try{b=a}catch(h){return false}var f=NLG.a.$2Z(c),d=this.$1g_0[f].length;switch(this.$2F_0[f]){case 0:return b>=0&&b<d;case 1:return !(b&-1<<d-1);case 2:return !!b&&!(b&-1<<d);default:throw NLG.ex.$6()}}else{var g=a;return !!g&&g.$s_0===c}}},$3F_0:function(a){switch(a){case 1:case 2:case 3:case 5:case 9:return true;default:if(NLG.a.$K(a))return this.$3F_0(NLG.a.$Z(a));else if(NLG.a.$1t(a))return this.$3E_0(a);else return this.$2A_0(a)}},$3E_0:function(b){var a=NLG.a.$2Z(b);return a>=0&&a<this.$2G_0.length},$2A_0:function(b){var a=NLG.a.$1r(b);return a>=0&&a<this.$2I_0.length},$1X_0:function(a){return this.$1e_0[a]},$37_0:function(a){return this.$1i_0[NLG.a.$1r(a)].length},$3B_0:function(a,b){return this.$1N_0[NLG.a.$1r(a)][b]},$Q_0:0,$13_0:function(a){var b=this.$N_0.$5_0,c=b[a.val];++a.val;if(NLG.a.$K(c)){var j=b[a.val];++a.val;for(var d=new NLG.lv(this,NLG.a.$Z(c)),e=0;e<j;++e)Array.add(d.$0_0,this.$13_0(a));return d}else switch(c){case 1:var k=b[a.val];++a.val;return this.$N_0.$H_0(k);case 2:var l=b[a.val]===1;++a.val;return l;case 3:var m=b[a.val];++a.val;return m;case 5:var n=b[a.val];++a.val;return this.$N_0.$1T_0[n];case 9:var o=b[a.val];++a.val;for(var f=new NLG.fb(this),g=0;g<o;++g){var p=b[a.val];++a.val;f.$e_0(p,this.$13_0(a))}return f;default:if(NLG.a.$1t(c)){var q=b[a.val];++a.val;return q}else{var r=b[a.val];++a.val;for(var h=new NLG.sv(this,c),i=0;i<r;++i){var s=b[a.val];++a.val;h.$2R_0(s,this.$13_0(a))}return h}}},$N_0:null,$2C_0:null,$2D_0:null,$1e_0:null,$2G_0:null,$2F_0:null,$1g_0:null,$2I_0:null,$1j_0:null,$1i_0:null,$1N_0:null};NLG.fb=function(a){if(!a)throw NLG.ex.$t("annotations");this.$4_0=a};NLG.fb.prototype={$J_0:function(a){if(a<0||a>=this.$4_0.$Q_0)throw NLG.ex.$8("attributeID");if(!this.$F_0)return null;var b=this.$F_0[a];return b===undefined?null:b},$e_0:function(a,b){if(this.$P_0)throw NLG.ex.$O("");if(a<0||a>=this.$4_0.$Q_0)throw NLG.ex.$8("attributeID");if(!this.$4_0.$1H_0(this.$4_0.$1Y_0(a),b))throw NLG.ex.$8("value");NLG.a.$w(b);if(!this.$F_0)this.$F_0=new Array(this.$4_0.$Q_0);this.$F_0[a]=b},get_$2i_0:function(){if(!this.$F_0)return false;for(var b=this.$F_0,c=b.length,a=0;a<c;++a){var d=b[a];if(d)return true}return false},$1B_0:function(a){if(this.$P_0)throw NLG.ex.$O("");if(a<0||a>=this.$4_0.$Q_0)throw NLG.ex.$8("attributeID");if(this.$F_0)this.$F_0[a]=null},$m_0:function(b){if(this.$P_0)throw NLG.ex.$O("");if(!b)throw NLG.ex.$8("other");if(b.$4_0!==this.$4_0)throw NLG.ex.$8("other");if(!this.$F_0)this.$F_0=new Array(this.$4_0.$Q_0);for(var a=0;a<this.$4_0.$Q_0;++a)this.$F_0[a]=!b.$F_0?undefined:b.$F_0[a]},$P_0:false,$1b_0:function(b){if(this===b)return true;if(!b||this.$4_0!==b.$4_0)return false;for(var a=0;a<this.$4_0.$Q_0;++a){var d=!this.$F_0?undefined:this.$F_0[a],c=!b.$F_0?undefined:b.$F_0[a];if(d===undefined?c!==undefined:c===undefined||!NLG.a.$2T(this.$4_0.$1Y_0(a),d,c))return false}return true},$11_0:function(){var a=new NLG.fb(this.$4_0);a.$m_0(this);return a},$2B_0:function(){if(this.$P_0)return;this.$P_0=true;if(this.$F_0)for(var a=0;a<this.$4_0.$Q_0;++a)NLG.a.$w(this.$F_0[a])},$4_0:null,$F_0:null};NLG.sv=function(a,b){if(!a)throw NLG.ex.$t("annotations");if(!a.$2A_0(b))throw NLG.ex.$8("structTypeID");this.$4_0=a;this.$p_0=this.$4_0.$37_0(b);this.$s_0=b};NLG.sv.prototype={$s_0:0,$v_0:function(a){if(a<0||a>=this.$p_0)throw NLG.ex.$8("iField");if(this.$X_0&&this.$X_0[a]!==undefined)return this.$X_0[a];else return this.$4_0.$3B_0(this.$s_0,a)},$2R_0:function(a,b){if(this.$P_0)throw NLG.ex.$O("");if(a<0||a>=this.$p_0)throw NLG.ex.$8("iField");if(!this.$4_0.$1H_0(this.$4_0.$1Z_0(this.$s_0,a),b))throw NLG.ex.$8("value");if(!this.$X_0)this.$X_0=new Array(this.$p_0);this.$X_0[a]=b},$P_0:false,$1b_0:function(b){if(this===b)return true;if(!b||this.$4_0!==b.$4_0||this.$s_0!==b.$s_0)return false;for(var a=0;a<this.$p_0;++a)if(!NLG.a.$2T(this.$4_0.$1Z_0(this.$s_0,a),this.$v_0(a),b.$v_0(a)))return false;return true},$11_0:function(){var b=new NLG.sv(this.$4_0,this.$s_0);if(this.$X_0){b.$X_0=new Array(this.$p_0);for(var a=0;a<this.$p_0;++a)b.$X_0[a]=this.$X_0[a]}return b},$2B_0:function(){if(this.$P_0)return;this.$P_0=true;if(this.$X_0)for(var a=0;a<this.$p_0;++a)NLG.a.$w(this.$X_0[a])},$4_0:null,$p_0:0,$X_0:null};NLG.lv=function(a,b){this.$4_0=a;this.$i_0=b;this.$0_0=new Array(0)};NLG.lv.prototype={$i_0:0,$0_0:null,$P_0:false,$1b_0:function(a){if(this===a)return true;if(!a||a.$4_0!==this.$4_0||a.$i_0!==this.$i_0||a.$0_0.length!==this.$0_0.length)return false;for(var b=0;b<this.$0_0.length;++b)if(!NLG.a.$2T(this.$i_0,this.$0_0[b],a.$0_0[b]))return false;return true},$11_0:function(){for(var c=new NLG.lv(this.$4_0,this.$i_0),b=this.$0_0,d=b.length,a=0;a<d;++a){var e=b[a];Array.add(c.$0_0,e)}return c},$2B_0:function(){if(this.$P_0)return;this.$P_0=true;for(var b=this.$0_0,c=b.length,a=0;a<c;++a){var d=b[a];NLG.a.$w(d)}},$4_0:null};NLG.snr=function(a,b,c){this.g=this.$3Y_0;this.$2m_0=a;this.$2k_0=b;this.$17_0=c};NLG.snr.prototype={$3Y_0:function(a){if(null===a||!a.length)throw NLG.ex.$8("name");var b=a.charCodeAt(0),c=a.substr(1);if(b===1&&c===this.$2m_0)return this.$2k_0;return !this.$17_0?null:this.$17_0.g(a)},$2m_0:null,$2k_0:null,$17_0:null};NLG.aq=function(){};NLG.aq.$B=function(b,Sb,a,d){var h=b.$5_0,g=h[Sb],Cb=h[g];g+=3;var Db=h[g]===1;++g;if(!Db&&!b.$2_0.$1H_0(Cb,a))throw NLG.ex.$8("obj");var n=h[g];++g;var Eb=g;g+=n;var Fb=g;g+=n;var Gb=g;g+=n;for(var Hb=g,k=0;k<n;++k){var f=h[Eb+k],e=h[Fb+k],i=Hb+h[Gb+k],c=i<h.length?h[i]:0;switch(e){case 1:a=!d?null:d.g(b.$H_0(c));if(!a)throw NLG.ex.$O("");break;case 2:a=!!d&&!!d.g(b.$H_0(c));break;case 3:if(f===9){a=a.$J_0(c);if(null===a)a=b.$2_0.$1X_0(c)}else{for(var Y=new NLG.lv(b.$2_0,b.$2_0.$1Y_0(c)),R=a.$0_0,xb=R.length,y=0;y<xb;++y){var Jb=R[y],F=Jb.$J_0(c);if(null===F)F=b.$2_0.$1X_0(c);Array.add(Y.$0_0,F)}a=Y}break;case 4:if(!NLG.a.$K(f))a=a.$v_0(c);else{for(var ab=new NLG.lv(b.$2_0,b.$2_0.$1Z_0(NLG.a.$Z(f),c)),T=a.$0_0,zb=T.length,A=0;A<zb;++A){var Lb=T[A];Array.add(ab.$0_0,Lb.$v_0(c))}a=ab}break;case 5:if(NLG.aq.$B(b,c,a,d))a=NLG.aq.$B(b,h[i+1],a,d);else if(h[i+2])a=NLG.aq.$B(b,h[i+2],a,d);break;case 6:if(!NLG.a.$K(f))a=NLG.f.$E(b,c,a,d);else{for(var cb=new NLG.lv(b.$2_0,2),V=a.$0_0,Bb=V.length,C=0;C<Bb;++C){var Nb=V[C];Array.add(cb.$0_0,NLG.f.$E(b,c,Nb,d))}a=cb}break;case 43:a=NLG.f.$E(b,c,a,d);break;case 7:throw NLG.ex.$6();case 45:if(f===9){var db=new NLG.fb(b.$2_0);db.$m_0(a);var eb=new NLG.fb(b.$2_0);NLG.as.$14(b,c,null,new NLG.snr("Input",db,new NLG.snr("Output",eb,d)));a=eb}else{for(var fb=new NLG.lv(b.$2_0,9),Q=a.$0_0,wb=Q.length,x=0;x<wb;++x){var Ob=Q[x],hb=new NLG.fb(b.$2_0);hb.$m_0(Ob);var ib=new NLG.fb(b.$2_0);NLG.as.$14(b,c,null,new NLG.snr("Input",hb,new NLG.snr("Output",ib,d)));Array.add(fb.$0_0,ib)}a=fb}break;case 46:var W,X;a=(X=b.$2_0.$13_0(W={val:i}),i=W.val,X);NLG.a.$w(a);break;case 13:case 14:var K=a,r=e===14&&!c?0:NLG.aq.$B(b,c,a,d);if(r<0||r>=K.$0_0.length)throw NLG.ex.$O("");else a=K.$0_0[e===14?K.$0_0.length-r-1:r];break;case 15:a=a.$0_0.length;break;case 24:var lb=NLG.aq.$B(b,c,a,d),m=a.$11_0(),nb=NLG.aq.$g(b,c);if(NLG.a.$K(nb))for(var ob=lb,S=ob.$0_0,yb=S.length,z=0;z<yb;++z){var Rb=S[z];Array.add(m.$0_0,NLG.aq.$1y(b.$2_0,Rb,ob.$i_0,m.$i_0))}else Array.add(m.$0_0,NLG.aq.$1y(b.$2_0,lb,nb,m.$i_0));a=m;break;case 27:for(var pb=new NLG.lv(b.$2_0,NLG.a.$Z(f)),U=a.$0_0,Ab=U.length,B=0;B<Ab;++B){var qb=U[B];NLG.f.$E(b,c,qb,d)&&Array.add(pb.$0_0,qb)}a=pb;break;case 34:case 35:case 36:case 37:case 38:case 39:var o=NLG.aq.$B(b,c,a,d);if(NLG.a.$K(f)){var p=a,D=NLG.a.$Z(f),E=new NLG.lv(b.$2_0,D);if(!NLG.a.$K(NLG.aq.$g(b,c)))for(var L=p.$0_0,rb=L.length,s=0;s<rb;++s){var Ib=L[s];Array.add(E.$0_0,NLG.aq.$1n(e,Ib,o,D===5))}else{var Z=o;if(p.$0_0.length!==Z.$0_0.length)throw NLG.ex.$O("");for(var q=0;q<p.$0_0.length;++q)Array.add(E.$0_0,NLG.aq.$1n(e,p.$0_0[q],Z.$0_0[q],D===5))}a=E}else if(!NLG.a.$K(NLG.aq.$g(b,c)))a=NLG.aq.$1n(e,a,o,f===5);else{for(var Kb=o,bb=new NLG.lv(b.$2_0,f),M=Kb.$0_0,sb=M.length,t=0;t<sb;++t){var Mb=M[t];Array.add(bb.$0_0,NLG.aq.$1n(e,a,Mb,f===5))}a=bb}break;case 40:case 41:if(f===2&&NLG.aq.$g(b,c)===2&&(a?e===41:e===40))a=e===41;else if(NLG.a.$K(f)){var l=a,G=new NLG.lv(b.$2_0,2),H=NLG.aq.$B(b,c,a,d);if(!NLG.a.$K(NLG.aq.$g(b,c)))for(var N=l.$0_0,tb=N.length,u=0;u<tb;++u){var gb=N[u];Array.add(G.$0_0,e===40?H&&gb:H||gb)}else{var I=H;if(l.$0_0.length!==I.$0_0.length)throw NLG.ex.$O("");for(var j=0;j<l.$0_0.length;++j)Array.add(G.$0_0,e===40?I.$0_0[j]&&l.$0_0[j]:I.$0_0[j]||l.$0_0[j])}a=G}else{var J=NLG.aq.$B(b,c,a,d);if(!NLG.a.$K(NLG.aq.$g(b,c)))a=e===40?J&&a:J||a;else{for(var Pb=J,jb=new NLG.lv(b.$2_0,2),O=Pb.$0_0,ub=O.length,v=0;v<ub;++v){var kb=O[v];Array.add(jb.$0_0,e===40?kb&&a:kb||a)}a=jb}}break;case 42:if(NLG.a.$K(f)){for(var mb=new NLG.lv(b.$2_0,2),P=a.$0_0,vb=P.length,w=0;w<vb;++w){var Qb=P[w];Array.add(mb.$0_0,!Qb)}a=mb}else a=!a;break;default:if(e>=0&&e<=47)throw NLG.ex.$6();else throw NLG.ex.$6()}}return a};NLG.aq.$f=function(b,k,g,j,d,h,a){var f=b.$5_0,c=f[k],lb=f[c];++c;var mb=f[c];++c;var nb=!!f[c];++c;if(!nb)throw NLG.ex.$O("");var ob=!!f[c];++c;if(!g){if(!ob&&!b.$2_0.$1H_0(lb,j))throw NLG.ex.$8("obj");if(!b.$2_0.$1H_0(mb,d))throw NLG.ex.$8("obj")}var i=f[c];++c;if(g<0||g>=i)throw NLG.ex.$8("iStep");var z=f[c+g];c+=i;var l=f[c+g];c+=i;var pb=c;c+=i;var q=c+f[pb+g],e=q<f.length?f[q]:0;switch(l){case 1:var t=!h?null:h.g(b.$H_0(e));if(!t)throw NLG.ex.$O("");var A=d,W,X,B=(X=NLG.aq.$16(k,g,i,W={val:a}),a=W.val,X);if(B)A=NLG.aq.$f(b,B.$k_0,B.$l_0,t,d,h,a);t!==A&&t.$m_0(A);return t;case 3:if(z===9){var C=j,ab=d,Y,N,D=(N=NLG.aq.$16(k,g,i,Y={val:a}),a=Y.val,N);if(D){var E=C.$J_0(e);if(null===E)E=b.$2_0.$1X_0(e);ab=NLG.aq.$f(b,D.$k_0,D.$l_0,NLG.aq.$1Q(E),d,h,a)}C.$e_0(e,ab);return C}else{var o=j,cb=d,O,P,G=(P=NLG.aq.$16(k,g,i,O={val:a}),a=O.val,P);if(G){for(var eb=new NLG.lv(b.$2_0,b.$2_0.$1Y_0(e)),M=o.$0_0,kb=M.length,y=0;y<kb;++y){var sb=M[y],H=sb.$J_0(e);if(null===H)H=b.$2_0.$1X_0(e);Array.add(eb.$0_0,H)}cb=NLG.aq.$f(b,G.$k_0,G.$l_0,eb,d,h,a)}var db=cb;if(db.$0_0.length!==o.$0_0.length)throw NLG.ex.$O("");for(var u=0;u<o.$0_0.length;++u){var v=o.$0_0[u];if(v.$P_0){v=v.$11_0();o.$0_0[u]=v}v.$e_0(e,db.$0_0[u])}return o}case 4:if(!NLG.a.$K(z)){var I=j,fb=d,Q,R,J=(R=NLG.aq.$16(k,g,i,Q={val:a}),a=Q.val,R);if(J)fb=NLG.aq.$f(b,J.$k_0,J.$l_0,NLG.aq.$1Q(I.$v_0(e)),d,h,a);I.$2R_0(e,fb);return I}else{var p=j,gb=d,S,T,K=(T=NLG.aq.$16(k,g,i,S={val:a}),a=S.val,T);if(K){for(var ib=new NLG.lv(b.$2_0,b.$2_0.$1Z_0(NLG.a.$Z(z),e)),L=p.$0_0,jb=L.length,x=0;x<jb;++x){var qb=L[x];Array.add(ib.$0_0,qb.$v_0(e))}gb=NLG.aq.$f(b,K.$k_0,K.$l_0,ib,d,h,a)}var hb=gb;if(hb.$0_0.length!==p.$0_0.length)throw NLG.ex.$O("");for(var r=0;r<p.$0_0.length;++r){var s=p.$0_0[r];if(s.$P_0){s=s.$11_0();p.$0_0[r]=s}s.$2R_0(e,hb.$0_0[r])}return p}case 5:var rb=NLG.aq.$B(b,e,j,h);if(g<i-1)a=new NLG.aq.c(k,g+1,a);if(rb)return NLG.aq.$f(b,f[q+1],0,j,d,h,a);else if(f[q+2])return NLG.aq.$f(b,f[q+2],0,j,d,h,a);else{var Z=d,w=null;if(a){w=new NLG.aq.c(a.$k_0,a.$l_0,null);a=a.$2O_0}if(w)Z=NLG.aq.$f(b,w.$k_0,w.$l_0,NLG.aq.$1Q(j),d,h,a);return Z}case 13:case 14:var m=j,n=l===14&&!e?0:NLG.aq.$B(b,e,j,h);if(n<0||n>=m.$0_0.length)throw NLG.ex.$O("");var bb=d,U,V,F=(V=NLG.aq.$16(k,g,i,U={val:a}),a=U.val,V);if(F)bb=NLG.aq.$f(b,F.$k_0,F.$l_0,NLG.aq.$1Q(m.$0_0[l===14?m.$0_0.length-n-1:n]),d,h,a);m.$0_0[l===14?m.$0_0.length-n-1:n]=bb;return m;default:if(l>=0&&l<=47)throw NLG.ex.$6();else throw NLG.ex.$6()}};NLG.aq.$g=function(c,d){var a=c.$5_0,b=a[d];return a[b+1]};NLG.aq.$1y=function(j,c,a,b){if(a===b)return c;if(a===3){if(b===5)return c}else if(a===5){if(b===3)return c}else if(NLG.a.$K(a)&&NLG.a.$K(b))if(NLG.a.$Z(a)===3){if(NLG.a.$Z(b)===5){for(var m=c,h=new NLG.lv(j,5),f=m.$0_0,k=f.length,d=0;d<k;++d){var n=f[d];Array.add(h.$0_0,n)}return h}}else if(NLG.a.$Z(a)===5)if(NLG.a.$Z(b)===3){for(var o=c,i=new NLG.lv(j,3),g=o.$0_0,l=g.length,e=0;e<l;++e){var p=g[e];Array.add(i.$0_0,p)}return i}throw NLG.ex.$O("")};NLG.aq.$1n=function(f,d,e,g){var b=Number.isInstanceOfType(d)?d:d,c=Number.isInstanceOfType(e)?e:e,a;switch(f){case 34:a=b+c;break;case 35:a=b-c;break;case 36:a=b*c;break;case 37:a=b/c;break;case 38:a=b%c;break;case 39:a=Math.pow(b,c);break;default:throw NLG.ex.$6()}if(g)return a;else return a};NLG.aq.$16=function(d,b,e,a){if(b<e-1)return new NLG.aq.c(d,b+1,null);if(a.val){var c=a.val;a.val=a.val.$2O_0;return c}return null};NLG.aq.$1Q=function(a){if(NLG.fb.isInstanceOfType(a)){var b=a;if(b.$P_0)a=b.$11_0()}else if(NLG.lv.isInstanceOfType(a)){var c=a;if(c.$P_0)a=c.$11_0()}else if(NLG.sv.isInstanceOfType(a)){var d=a;if(d.$P_0)a=d.$11_0()}return a};NLG.aq.c=function(a,b,c){this.$k_0=a;this.$l_0=b;this.$2O_0=c};NLG.as=function(){};NLG.as.$14=function(c,v,e,d){var a=c.$5_0,f=a[v],j=a[f];++f;var o=f;f+=j;var p=f;f+=j;for(var q=f,g=0;g<j;++g){var h=a[o+g],b=q+a[p+g];switch(h){case 1:case 2:var r=NLG.aq.$B(c,a[b+1],h===2?NLG.aq.$B(c,a[b],e,d):e,d);NLG.aq.$f(c,a[b],0,e,NLG.aq.$1y(c.$2_0,r,NLG.aq.$g(c,a[b+1]),NLG.aq.$g(c,a[b])),d,null);break;case 3:var l=NLG.aq.$B(c,a[b],e,d);if(NLG.aq.$g(c,a[b])===9)l.$1B_0(a[b+1]);else for(var k=l.$0_0,n=k.length,i=0;i<n;++i){var s=k[i];s.$1B_0(a[b+1])}break;case 6:var m=new NLG.fb(c.$2_0);a[b+1]>0&&m.$m_0(NLG.aq.$B(c,a[b+1],e,d));d=new NLG.snr(c.$H_0(a[b]),m,d);break;case 8:if(NLG.aq.$B(c,a[b],e,d))NLG.as.$14(c,a[b+1],e,d);else a[b+2]&&NLG.as.$14(c,a[b+2],e,d);break;case 10:var t=NLG.aq.$B(c,a[b],e,d),u=NLG.aq.$B(c,a[b+1],e,d);NLG.as.$14(c,a[b+2],e,new NLG.snr("Input",t,new NLG.snr("Output",u,d)));break;default:if(h>=0&&h<=10)throw NLG.ex.$6();else throw NLG.ex.$6()}}};NLG.cg=function(b,c){this.$N_0=b;this.$D_0=b.$5_0;var a=this.$D_0[c];this.$q_0=b.$H_0(this.$D_0[a]);++a;if(this.$D_0[a])throw NLG.ex.$6();++a;this.$2E_0=this.$D_0[a];++a;this.$1J_0=this.$D_0[a];++a;this.$2H_0=a;this.$2l_0=a+this.$1J_0;this.$1M_0=a+2*this.$1J_0;if(this.$D_0[this.$2H_0]===2)this.$1s_0=this.$N_0.$2g_0(this.$D_0[this.$D_0[this.$1M_0]])};NLG.cg.$3H=function(i,g){for(var a=Array.clone(i),e=0;e<g.length;++e){var c=g[e],b=NLG.cg.$2y(a,c);if(b<0)~b===a.length&&!c.$A_0&&Array.add(a,c);else if(!c.$A_0){while(b>0&&a[b-1].$3_0===c.$3_0)--b;Array.insert(a,b,c)}else{for(var d=1;b+d<a.length;++d){if(a[b+d].$3_0>=c.$3_0+c.$A_0)break;for(var f=0;f<e;++f)if(g[f]===a[b+d]){d=0;break}if(!d)break}if(d>0){for(var h=0;h<d;++h)Array.removeAt(a,b);Array.insert(a,b,c)}}}return a};NLG.cg.$2y=function(e,f){var a=0,c=e.length-1;while(a<=c){var b=a+(c-a>>1),d=e[b].$3_0-f.$3_0;if(!d)return b;if(d<0)a=b+1;else c=b-1}return ~a};NLG.cg.prototype={$q_0:null,$1s_0:null,$3I_0:function(m,n,o,p,h){for(var e=new NLG.fb(this.$N_0.$2_0),g=new NLG.snr("Whiteboard",e,null),c=p||NLG.cg.$2Q,a=0;a<this.$1J_0;++a){if(h>0&&(new Date).getTime()>h)throw NLG.ex.$2v();var b=this.$D_0[this.$2H_0+a];if(!a&&(b===1||b===2)&&p)continue;var j=this.$D_0[this.$2l_0+a];if(j&&!NLG.f.$E(this.$N_0,j,e,g))continue;var d=null,k=false;if(b===1)throw NLG.ex.$6();else if(b===2)c=this.$N_0.$2g_0(this.$D_0[this.$D_0[this.$1M_0+a]]).$2w_0(m,n,o);else if(b===4){var r=this.$D_0[this.$D_0[this.$1M_0+a]];d=new Array(0);for(var i=c,q=i.length,f=0;f<q;++f){var l=i[f];!NLG.f.$E(this.$N_0,r,l,g)&&Array.add(d,l)}}else if(b===3)throw NLG.ex.$6();else if(b===5){d=this.$2x_0(m,n,o,c,e,g,this.$D_0[this.$1M_0+a],h);k=true}else throw NLG.ex.$O("");if(!k||a===this.$1J_0-1)c=d;else if(d.length)c=NLG.cg.$3H(c,d)}return e},$2x_0:function(v,w,x,g,h,k,d,q){var r=this.$D_0[d];++d;var s=new NLG.sim(g,v),c=0;while(c<g.length){if(q>0&&(new Date).getTime()>q)throw NLG.ex.$2v();for(var f=-1,a=null,t=g.length-c,e=0;e<r;++e){var m=this.$D_0[d+4*e];if(m&&!NLG.f.$E(this.$N_0,m,h,k))continue;var i=this.$N_0.$2h_0(this.$D_0[d+4*e+1]);if(i.$19_0.$2M_0>t)continue;else if(a&&i.$19_0.$Y_0<=a.$L_0)continue;var j=i.$2f_0(s,0,g.length,c,false,0,w,x,k);if(j&&(!a||j.$L_0>a.$L_0)){f=e;a=j}}if(f>=0){var n=this.$D_0[d+4*f+2];n&&NLG.as.$14(this.$N_0,n,h,new NLG.renr(this.$N_0.$2_0,a,k));var o=this.$D_0[d+4*f+3],p=false;if(o)for(var u=this.$N_0.$H_0(o),b=a.$u_0;b;b=b.$r_0)if(u===b.$q_0){if(b.$G_0+b.$L_0>c){p=true;c=b.$G_0+b.$L_0}break}if(!p)c+=Math.max(a.$L_0,1)}else++c}var l=h.$J_0(this.$2E_0);h.$1B_0(this.$2E_0);if(l)return this.$3X_0(l);else return NLG.cg.$2Q},$3X_0:function(g){for(var e=new Array(0),d=g.$0_0,f=d.length,c=0;c<f;++c){var b=d[c];if(null===b.$J_0(0)||null===b.$J_0(1))continue;var a=new NLG.ts(b.$J_0(0),b.$J_0(1));a.$T_0=new NLG.fb(this.$N_0.$2_0);a.$T_0.$m_0(b);a.$T_0.$1B_0(0);a.$T_0.$1B_0(1);a.$T_0.$1B_0(2);Array.add(e,a)}return e},$N_0:null,$2E_0:0,$D_0:null,$1J_0:0,$2H_0:0,$2l_0:0,$1M_0:0};NLG.f=function(){};NLG.f.$E=function(c,k,b,d){try{var g=c.$5_0,a=g[k],e=g[a];switch(e-e%100){case 0:for(var j=g[a+1],f=e===1,h=0;h<j;++h){f=NLG.f.$E(c,g[a+2+h],b,d);if(f?e===2:e===1)return f}if(e===3)f=!f;return f;case 100:return NLG.f.$3U(c,a,b,d);case 200:return NLG.f.$3P(c,a,b,d);case 300:return NLG.f.$3S(c,a,Number.isInstanceOfType(b)?b:b,d);case 400:return NLG.f.$3Q(c,a,b,d);case 500:return NLG.f.$3V(c,a,b,d);case 600:return NLG.f.$3R(c,a,b,d);case 700:return NLG.f.$3O(c,a,b,d);case 800:return NLG.f.$3N(c,a,b,d);case 900:return NLG.f.$3W(c,a,b,d);case 1e3:return NLG.f.$3T(c,a,b,d);default:return false}}catch(i){throw NLG.ex.$8("objToTest")}};NLG.f.$3U=function(f,d,a,g){var c=f.$5_0,e=c[d];if(e===101)return f.$38_0(c[d+1]).test(a);else if(e===102)throw NLG.ex.$6();else{var b=NLG.aq.$B(f,c[d+1],null,g);if(c[d+2]===1){a=a.toUpperCase();b=b.toUpperCase()}switch(e){case 103:return a===b;case 104:return a.indexOf(b)>=0;case 105:return a.startsWith(b);case 106:return a.endsWith(b);case 107:return b.indexOf(a)>=0;case 108:return b.startsWith(a);case 109:return b.endsWith(a);default:throw NLG.ex.$6()}}};NLG.f.$3P=function(c,b,d,f){var a=c.$5_0,e=a[b];switch(e){case 201:return d===(a[b+1]===1);case 202:return d===NLG.aq.$B(c,a[b+1],null,f);default:throw NLG.ex.$6()}};NLG.f.$3S=function(e,d,b,g){var c=e.$5_0,f=c[d],a=e.$1T_0[c[d+1]];if(c[d+2]>0)a+=NLG.aq.$B(e,c[d+2],null,g);switch(f){case 301:return b===a;case 302:return b<a;case 303:return b<=a;case 304:return b>a;case 305:return b>=a;default:throw NLG.ex.$6()}};NLG.f.$3Q=function(h,f,a,i){var d=h.$5_0,g=d[f],e=d[f+1]===1,b=d[f+2];switch(g){case 401:return e?!b?!a:!!(a&b):a===b;case 402:return e?(a&b)===b:a<32&&(1<<a&b)===b;case 403:return e?!!(a&b):a<32&&!!(1<<a&b);default:var c=NLG.aq.$B(h,b,null,i);switch(g){case 404:return a===c;case 405:return 0!==(a&c);case 406:return a===(a&c);case 407:return c===(a&c);default:throw NLG.ex.$6()}}};NLG.f.$3V=function(c,b,d,e){var a=c.$5_0,f=a[b];switch(f){case 501:return NLG.f.$E(c,a[b+2],d.$v_0(a[b+1]),e);case 502:return d.$1b_0(NLG.aq.$B(c,a[b+1],null,e));default:throw NLG.ex.$6()}};NLG.f.$3R=function(f,g,j,k){var e=f.$5_0,a=e[g];switch(a){case 601:case 602:for(var b=a===602,d=j.$0_0,h=d.length,c=0;c<h;++c){var i=d[c];b=NLG.f.$E(f,e[g+1],i,k);if(b?a===601:a===602)return b}return b;default:throw NLG.ex.$6()}};NLG.f.$3O=function(d,b,c,g){var a=d.$5_0,h=a[b];switch(h){case 701:return c.get_$2i_0();case 702:return !c.get_$2i_0();case 703:return null!==c.$J_0(a[b+1]);case 704:return null===c.$J_0(a[b+1]);case 705:var e=c.$J_0(a[b+1]);return null!==e&&NLG.f.$E(d,a[b+2],e,g);case 706:var f=c.$J_0(a[b+1]);return null===f||NLG.f.$E(d,a[b+2],f,g);default:throw NLG.ex.$6()}};NLG.f.$3N=function(e,f,a,i){var d=e.$5_0,l=d[f];switch(l){case 802:for(var g=a.$0_0,j=g.length,b=0;b<j;++b){var m=g[b];if(NLG.f.$E(e,d[f+1],m,i))return true}return false;case 803:for(var h=a.$0_0,k=h.length,c=0;c<k;++c){var n=h[c];if(!NLG.f.$E(e,d[f+1],n,i))return false}return a.$0_0.length>0;case 801:return a.$0_0.length>0;default:throw NLG.ex.$6()}};NLG.f.$3W=function(c,b,d,e){var a=c.$5_0,f=a[b];if(f!==901)throw NLG.ex.$6();return (!a[b+2]||NLG.f.$E(c,a[b+2],d.$1A_0.substr(d.$1C_0.$3_0,d.$1C_0.$A_0),e))&&(!a[b+3]||NLG.f.$E(c,a[b+3],d.$1C_0.$T_0||new NLG.fb(c.$2_0),e))&&(!a[b+4]||NLG.f.$E(c,a[b+4],d.$1C_0.$3_0,e))&&(!a[b+5]||NLG.f.$E(c,a[b+5],d.$1C_0.$A_0,e))};NLG.f.$3T=function(i,j,d,n){var h=i.$5_0,o=h[j];switch(o){case 1001:var l=i.$H_0(h[j+1]),k=l.charCodeAt(0),p=l.substr(1),c=-1,f=-1,e=-1,g=-1,a=d.$2t_0;switch(k){case 4:c=a.$G_0;f=a.$L_0;e=a.$3_0;g=a.$A_0;break;case 5:c=d.$o_0;f=a.$G_0-d.$o_0;e=a.$R_0;g=a.$3_0-a.$R_0;break;case 6:c=a.$G_0+a.$L_0;f=d.$o_0+d.$1S_0-c;e=a.$3_0+a.$A_0;g=a.$R_0+a.$y_0-e;break;case 1:case 2:case 3:for(var m=false,b=a.$u_0;b;b=b.$r_0)if(p===b.$q_0){m=true;if(k===1){c=b.$G_0;f=b.$L_0;e=b.$3_0;g=b.$A_0}else if(k===2){c=d.$o_0;f=b.$G_0-d.$o_0;e=a.$R_0;g=b.$3_0-a.$R_0}else{c=b.$G_0+b.$L_0;f=d.$o_0+d.$1S_0-c;e=b.$3_0+b.$A_0;g=a.$R_0+a.$y_0-e}break}if(!m)return false;break;case 7:c=d.$o_0;f=d.$1S_0;e=a.$R_0;g=a.$y_0;break;default:throw NLG.ex.$6()}return null!==i.$2h_0(h[j+2]).$2f_0(a.$M_0,c,f,c,true,2,e,g,n);case 1002:return NLG.aq.$B(i,h[j+1],null,n);default:throw NLG.ex.$6()}};NLG.f.t=function(a,b){this.$1C_0=a;this.$1A_0=b};NLG.iu=function(){};NLG.of=function(b){var a=new NLG.ri;a.$b_0=0;var c=NLG.of.$V(b,null,a);this.$I_0=new Array(c);for(var e=0;e<c;++e)this.$I_0[e]=NLG.of.$1G(b,a);var n=NLG.of.$V(b,null,a);this.$5_0=new Array(n);var d=c;this.$5_0[0]=d;for(var f=0;f<c-1;++f){d+=NLG.of.$1G(b,a);this.$5_0[f+1]=d}for(var o=NLG.of.$V(b,null,a),p=new Array(o),g=0;g<o;++g)p[g]=NLG.of.$V(b,null,a);for(var h=c;h<n;++h)this.$5_0[h]=NLG.of.$V(b,p,a);var q=NLG.of.$V(b,null,a);this.$1T_0=new Array(q);for(var i=0;i<q;++i){var w=b.indexOf("D",a.$b_0);this.$1T_0[i]=parseFloat(b.substr(a.$b_0,w-a.$b_0));a.$b_0=w+1}var r=NLG.of.$V(b,null,a);this.$2V_0=new Array(r);for(var j=0;j<r;++j){var x=NLG.of.$V(b,null,a),y=new Array(x);this.$2V_0[j]=y;for(var k=0;k<x;++k)y[k]=NLG.of.$1G(b,a)}for(var s=NLG.of.$V(b,null,a),t=new Array(s),l=0;l<s;++l)t[l]=NLG.of.$V(b,null,a);for(var u=NLG.of.$V(b,null,a),v=new Array(u),m=0;m<u;++m)v[m]=t[NLG.of.$1G(b,a)];var z=String.fromCharCode.apply(null,v);this.$a_0=new Array(c);this.$3D_0(z)};NLG.of.$V=function(c,g,a){var b=NLG.of.$20(c.charCodeAt(a.$b_0));++a.$b_0;if(b===92)return 0-NLG.of.$V(c,null,a);else if(b===91)return g[NLG.of.$1G(c,a)+27];else if(b>=64)return g[b-64];else{var e=0,f=0,d=b;while(true){e|=(d&31)<<5*f;if(d&32)break;++f;d=NLG.of.$20(c.charCodeAt(a.$b_0));++a.$b_0}return e}};NLG.of.$1G=function(d,c){var a=0;while(true){var b=NLG.of.$20(d.charCodeAt(c.$b_0));++c.$b_0;a+=b;if(b<92)break}return a};NLG.of.$20=function(b){var a=b-32;if(b>92)return a-2;else if(b>34)return a-1;else return a};NLG.of.prototype={$2_0:null,$34_0:function(c){for(var a=0;a<this.$I_0.length;++a)if(this.$I_0[a]===8){var b=this.$a_0[a];if(b.$q_0===c)return b}return null},$5_0:null,$2V_0:null,$1T_0:null,$H_0:function(a){return this.$a_0[a]},$38_0:function(a){return this.$a_0[a]},$2h_0:function(a){return this.$a_0[a]},$2g_0:function(a){return this.$a_0[a]},$3D_0:function(j){for(var b=0;b<this.$I_0.length;++b)if(this.$I_0[b]===1){var h=this.$5_0[b];this.$a_0[b]=j.substr(this.$5_0[h],this.$5_0[h+1])}this.$2_0=new NLG.a(this,0);for(var c=0;c<this.$I_0.length;++c)if(this.$I_0[c]===2){var i=this.$5_0[c];this.$a_0[c]=new RegExp(this.$H_0(this.$5_0[i]),this.$5_0[i+1]===1?"i":"")}for(var d=0;d<this.$I_0.length;++d)if(this.$I_0[d]===3)this.$a_0[d]=new NLG.sre(this,d);for(var f=0;f<this.$I_0.length;++f)if(this.$I_0[f]===4)throw NLG.ex.$6();for(var a=0;a<this.$I_0.length;++a)if(this.$I_0[a]===5)throw NLG.ex.$6();else if(this.$I_0[a]===6)this.$a_0[a]=new NLG.tk(this,a);for(var g=0;g<this.$I_0.length;++g)if(this.$I_0[g]===7)throw NLG.ex.$6();for(var e=0;e<this.$I_0.length;++e)if(this.$I_0[e]===8)this.$a_0[e]=new NLG.cg(this,e)},$I_0:null,$a_0:null};NLG.renr=function(a,b,c){this.g=this.$3Y_0;this.$4_0=a;this.$7_0=b;this.$17_0=c};NLG.renr.prototype={$3Y_0:function(i){if(null===i||!i.length)throw NLG.ex.$8("name");var b=i.charCodeAt(0),l=i.substr(1);if(b===7||b===4||b===5||b===6){var c,d;switch(b){case 7:c=this.$7_0.$R_0;d=this.$7_0.$y_0;break;case 4:c=this.$7_0.$3_0;d=this.$7_0.$A_0;break;case 5:c=this.$7_0.$R_0;d=this.$7_0.$3_0-this.$7_0.$R_0;break;case 6:c=this.$7_0.$3_0+this.$7_0.$A_0;d=this.$7_0.$R_0+this.$7_0.$y_0-c;break;default:throw NLG.ex.$6()}var f=new NLG.fb(this.$4_0);if(b===4&&this.$7_0.$L_0===1)this.$7_0.$M_0.$9_0[this.$7_0.$G_0].$T_0&&f.$m_0(this.$7_0.$M_0.$9_0[this.$7_0.$G_0].$T_0);f.$e_0(0,c);f.$e_0(1,d);f.$e_0(2,this.$7_0.$M_0.$1A_0.substr(c,d));return f}else for(var a=this.$7_0.$u_0;a;a=a.$r_0)if(l===a.$q_0){var e,g,j=-1;switch(b){case 2:e=this.$7_0.$R_0;g=a.$3_0-this.$7_0.$R_0;break;case 3:e=a.$3_0+a.$A_0;g=this.$7_0.$R_0+this.$7_0.$y_0-e;break;case 1:e=a.$3_0;g=a.$A_0;if(a.$L_0===1)j=a.$G_0;break;default:throw NLG.ex.$6()}var h=new NLG.fb(this.$4_0);if(j>=0){var k=this.$7_0.$M_0.$9_0[j];k.$T_0&&h.$m_0(k.$T_0)}h.$e_0(0,e);h.$e_0(1,g);h.$e_0(2,this.$7_0.$M_0.$1A_0.substr(e,g));return h}return !this.$17_0?null:this.$17_0.g(i)},$4_0:null,$7_0:null,$17_0:null};NLG.bfm=function(){};NLG.bfm.$3G=function(c,n,d,h,b,o,e,p,z,A,v){if(!c)throw NLG.ex.$t("nfa");if(!n)throw NLG.ex.$t("sreInputManager");if(d<0)throw NLG.ex.$8("iFirstItem");if(h<0)throw NLG.ex.$8("cTotalItems");if(b<(e?d-1:d)||b>(e?d+h-1:d+h))throw NLG.ex.$8("iStartMatchFrom");var g=e?b-d+1:d+h-b,q,r,s,t;if(!(t=NLG.bfm.$3L(c,e,q={val:g},r={val:b},s={val:o},d,h),g=q.val,b=r.val,o=s.val,t))return null;var a=NLG.bfm.$35();a.$21_0=true;a.$29_0(c,g);a.$26_0=e;a.$2S_0=p;a.$28_0=d;a.$2Y_0=h;a.$2c_0=c.$1F_0.length>0;a.$25_0=c.$1U_0.length>0;a.$27_0=o;a.$1k_0=o?2147483647:0;var i=null,j=-1;a.$1a_0=e?b+1:b-1;a.$1c_0=b;a.$10_0=0;a.$S_0.$2d_0(c.$1D_0[0],true,-1);if(a.$S_0.get_$1R_0()){i=a.$S_0.$2e_0();j=0;if(p===2)g=0}for(var f=0;f<g;++f){var k=e?b-f:b+f;a.$1a_0=k;a.$1c_0=e?k-1:k+1;a.$10_0=f+1;for(var w=n.$9_0[k],x=a.$S_0.get_$2N_0(),l=0;l<x;++l){var m=a.$S_0.$3A_0(l);if(m===1)continue;var u=c.$1D_0[m*2+1]&4194303;if(u!==NLG.nfa.$2n&&!NLG.f.$E(c.$1m_0,c.$1x_0[u],new NLG.f.t(w,n.$1A_0),v))continue;a.$U_0.$2d_0(c.$1D_0[m*2],!m,l);if(a.$U_0.$1l_0)break}if(a.$U_0.get_$1R_0()){i=a.$U_0.$2e_0();j=f+1-i.$x_0;if(p===2)break}if(f===g-1)break;else if(a.$U_0.get_$2N_0()<2&&(!a.$U_0.get_$2N_0()||a.$U_0.get_$1R_0()))break;else{var y=a.$S_0;a.$S_0=a.$U_0;a.$U_0=y;a.$U_0.$2X_0()}}a.$21_0=false;if(j<0)return null;else if(p===2)return NLG.bfm.$2u;else return NLG.bfm.$30(c,e,b,i,j,n,z,A,a)};NLG.bfm.$3L=function(a,e,b,d,c,f,g){if(a.$2M_0>b.val)return false;if(a.$2q_0)if(e){if(!c.val&&a.$Y_0<b.val)return false;if(c.val&&a.$Y_0<2147483647)if(b.val>a.$Y_0){d.val-=b.val-a.$Y_0;b.val-=b.val-a.$Y_0}}else{if(d.val>f)return false;c.val=false}if(a.$2p_0)if(e){if(d.val<f+g-1)return false;c.val=false}else{if(!c.val&&a.$Y_0<b.val)return false;if(c.val&&a.$Y_0<2147483647)if(b.val>a.$Y_0){d.val+=b.val-a.$Y_0;b.val-=b.val-a.$Y_0}}return true};NLG.bfm.$30=function(c,l,f,g,h,o,p,q,m){for(var d=l?f-g.$x_0-h+1:f+g.$x_0,a=new NLG.rem(o,p,q,d,h),i=c.$1q_0.length-1;i>=0;--i)NLG.bfm.$2U(a,c.$1q_0[i],d,h);for(var e=c.$1F_0.length-1;e>=0;--e)g.$12_0&1<<e&&NLG.bfm.$2U(a,c.$1F_0[e],d,h);if(m.$25_0){var j=g.$n_0;while(j!==-1){var b=m.$W_0[j],k=b.$2r_0,n=l?f-b.$15_0-k+1:f+b.$15_0;a.$u_0=new NLG.cr(c.$1U_0[b.$1P_0],n-d,k,a,a.$u_0);j=b.$r_0}}return a};NLG.bfm.$2U=function(d,a,e,f){var c,b=a.$2a_0;if(a.$1V_0>=0){c=e+a.$1V_0;if(b<0)b=f-a.$1V_0-a.$22_0}else c=e+f-a.$22_0-b;d.$u_0=new NLG.cr(a.$q_0,c-e,b,d,d.$u_0)};NLG.bfm.$35=function(){for(var a=null,c=NLG.bfm.$1o,e=c.length,b=0;b<e;++b){var d=c[b];if(!d.$21_0)a=d}if(!a){a=new NLG.bfm.m;NLG.bfm.$1o[NLG.bfm.$1o.length]=a}return a};NLG.bfm.m=function(){this.$W_0=new Array(100)};NLG.bfm.m.prototype={$29_0:function(a,b){this.$c_0=a;if(!this.$S_0)this.$S_0=new NLG.bfm.s(this);if(!this.$U_0)this.$U_0=new NLG.bfm.s(this);this.$S_0.$29_0();this.$U_0.$29_0();this.$1L_0=0;this.$2W_0=b},$S_0:null,$U_0:null,$21_0:false,$c_0:null,$26_0:false,$2S_0:0,$28_0:0,$2Y_0:0,$1a_0:0,$1c_0:0,$2W_0:0,$10_0:0,$1k_0:0,$2c_0:false,$25_0:false,$27_0:false,$36_0:function(){if(!this.$W_0[this.$1L_0])this.$W_0[this.$1L_0]=new NLG.bfm.c;++this.$1L_0;return this.$1L_0-1},$1L_0:0};NLG.bfm.c=function(){};NLG.bfm.e=function(){};NLG.bfm.s=function(a){this.$C_0=new Array(50);this.$1K_0=-1;this.$18_0=new Array(50);this.$1_0=a};NLG.bfm.s.prototype={$29_0:function(){this.$2j_0=this.$1_0.$c_0.$2s_0;this.$2X_0()},$2X_0:function(){this.$1f_0=0;this.$1K_0=-1;this.$1l_0=false;for(var b=(this.$2j_0>>5)+1,a=0;a<b;++a)this.$18_0[a]=0},get_$2N_0:function(){return this.$1f_0},get_$1R_0:function(){return this.$1K_0>=0},$1l_0:false,$3A_0:function(a){return this.$C_0[a].$1p_0},$2e_0:function(){var b=this.$C_0[this.$1K_0],a=new NLG.bfm.e;a.$1p_0=b.$1p_0;a.$x_0=b.$x_0;a.$j_0=b.$j_0;a.$n_0=b.$n_0;a.$12_0=b.$12_0;return a},$2d_0:function(d,n,i){var j=this.$1_0.$2W_0-this.$1_0.$10_0,k=!!(d&NLG.nfa.$24)&&d!==NLG.nfa.$1z,o=0,f=k?0:d===NLG.nfa.$1z?-1:this.$1_0.$c_0.$h_0[d]-1,l=n&&this.$1_0.$27_0;if(l)++f;for(var e=o;e<=f;++e){var c,b,a;if(l&&e===f)if(!this.get_$1R_0()){c=-1;b=-1;a=0}else break;else if(k){c=-1;b=d&~NLG.nfa.$24;a=b&2097151}else{var h=this.$1_0.$c_0.$h_0[d+1+e];if(h&NLG.nfa.$23){c=-1;b=h&~NLG.nfa.$23}else{c=h;b=this.$1_0.$c_0.$h_0[c]}a=b&2097151}if(this.$18_0[a>>5]&1<<a%32)continue;var p=this.$1_0.$c_0.$1D_0[a*2+1];if((p>>22&511)>j){this.$18_0[a>>5]|=1<<a%32;continue}if(!j&&a!==1){this.$18_0[a>>5]|=1<<a%32;continue}if(b!==-1){var m=b>>22&255;if(m)if(!this.$3K_0(m))continue}this.$18_0[a>>5]|=1<<a%32;var g=0;if(this.$1_0.$27_0&&i>=0){g=n?this.$1_0.$10_0:this.$1_0.$S_0.$C_0[i].$x_0;if(g>this.$1_0.$1k_0)continue}this.$31_0(a,i,c>=0&&b&2097152?this.$1_0.$c_0.$h_0[c+1]:0,c>=0&&b&NLG.nfa.$2b?this.$1_0.$c_0.$h_0[c+(b&2097152?1:0)+1]:-1,g);if(this.$1l_0)break}},$3K_0:function(a){if(a&1&&(this.$1_0.$26_0?this.$1_0.$1c_0:this.$1_0.$1a_0)>=this.$1_0.$28_0)return false;if(a&2&&(this.$1_0.$26_0?this.$1_0.$1a_0:this.$1_0.$1c_0)<this.$1_0.$28_0+this.$1_0.$2Y_0)return false;return true},$31_0:function(h,c,i,f,j){var a=this.$1f_0;++this.$1f_0;if(!this.$C_0[a])this.$C_0[a]=new NLG.bfm.e;this.$C_0[a].$1p_0=h;this.$C_0[a].$x_0=j;if(this.$1_0.$2c_0)if(c>=0)this.$C_0[a].$12_0=this.$1_0.$S_0.$C_0[c].$12_0|i;else this.$C_0[a].$12_0=i;if(this.$1_0.$25_0){if(c>=0){this.$C_0[a].$j_0=this.$1_0.$S_0.$C_0[c].$j_0;this.$C_0[a].$n_0=this.$1_0.$S_0.$C_0[c].$n_0}else{this.$C_0[a].$j_0=-1;this.$C_0[a].$n_0=-1}if(f>=0)for(var k=this.$1_0.$c_0.$h_0[f],e=0;e<k;++e){var g=this.$1_0.$c_0.$h_0[f+1+e],b=this.$1_0.$36_0();if(g>0){this.$1_0.$W_0[b].$1P_0=g;this.$1_0.$W_0[b].$15_0=this.$1_0.$10_0;this.$1_0.$W_0[b].$r_0=this.$C_0[a].$j_0;this.$C_0[a].$j_0=b}else{var d=this.$1_0.$W_0[this.$C_0[a].$j_0];this.$C_0[a].$j_0=d.$r_0;this.$1_0.$W_0[b].$1P_0=d.$1P_0;this.$1_0.$W_0[b].$15_0=d.$15_0;this.$1_0.$W_0[b].$2r_0=this.$1_0.$10_0-d.$15_0;this.$1_0.$W_0[b].$r_0=this.$C_0[a].$n_0;this.$C_0[a].$n_0=b}}}if(h===1){this.$1K_0=a;this.$1_0.$1k_0=Math.min(this.$1_0.$1k_0,j);if(!this.$1_0.$2S_0||this.$1_0.$2S_0===2)this.$1l_0=true}},$1_0:null,$2j_0:0,$1f_0:0};NLG.nfa=function(d,a){this.$1m_0=d;var b=d.$5_0;this.$2s_0=b[a];++a;var c=b[a];++a;this.$1D_0=new Array(c);for(var e=0;e<c;++e){this.$1D_0[e]=b[a];++a}c=b[a];++a;this.$h_0=new Array(c);for(var f=0;f<c;++f){this.$h_0[f]=b[a];++a}c=b[a];++a;this.$1x_0=new Array(c);for(var g=0;g<c;++g){this.$1x_0[g]=b[a];++a}++a;c=b[a];++a;this.$1q_0=new Array(c);for(var h=0;h<c;++h){this.$1q_0[h]=new NLG.nfa.s(d.$H_0(b[a]),b[a+1],b[a+2],b[a+3]);a+=4}c=b[a];++a;this.$1F_0=new Array(c);for(var i=0;i<c;++i){this.$1F_0[i]=new NLG.nfa.s(d.$H_0(b[a]),b[a+1],b[a+2],b[a+3]);a+=4}c=b[a];++a;this.$1U_0=new Array(c);for(var j=0;j<c;++j){this.$1U_0[j]=d.$H_0(b[a]);++a}this.$2M_0=b[a];++a;this.$Y_0=b[a];++a;this.$2q_0=!!b[a];++a;this.$2p_0=!!b[a];++a};NLG.nfa.prototype={$1m_0:null,$2s_0:0,$1D_0:null,$h_0:null,$1x_0:null,$1q_0:null,$1F_0:null,$1U_0:null,$2M_0:0,$Y_0:0,$2q_0:false,$2p_0:false};NLG.nfa.s=function(a,b,c,d){this.$q_0=a;this.$2a_0=b;this.$1V_0=c;this.$22_0=d};NLG.sre=function(b,c){var a=b.$5_0[c];this.$2L_0=b.$5_0[a];++a;this.$19_0=new NLG.nfa(b,a)};NLG.sre.prototype={$2f_0:function(c,d,e,g,h,i,j,k,f){if(!c)throw NLG.ex.$t("inputManager");var a=NLG.bfm.$3G(this.$19_0,c,d,e,g,h,false,i,j,k,f);if(!a)return null;if(this.$2L_0){var b=new NLG.sre.w;b.$2t_0=a;b.$o_0=d;b.$1S_0=e;if(!NLG.f.$E(this.$19_0.$1m_0,this.$2L_0,b,new NLG.renr(this.$19_0.$1m_0.$2_0,a,f)))return null}return a},$19_0:null,$2L_0:0};NLG.sre.w=function(){};NLG.tk=function(d,f){this.$4_0=d.$2_0;var b=d.$5_0,a=b[f];this.$2K_0=b[a];++a;var e=b[a];++a;this.$1h_0=new Array(e);this.$2J_0=new Array(e);for(var c=0;c<e;++c){this.$1h_0[c]=new RegExp(d.$H_0(b[a]));++a;this.$2J_0[c]=d.$H_0(b[a]);++a}};NLG.tk.prototype={$2w_0:function(a,g,k){var c=g,i=new Array(0);if(g>0)a=a.substr(g);while(c<g+k){for(var d=-1,j=-1,e=-1,f=0;f<this.$1h_0.length;++f){var b=this.$1h_0[f].exec(a);if(b&&b[0].length>0&&b[1].length>0)if(d<0||b[0].length>j){d=f;j=b[0].length;e=b[1].length}}if(d>=0){var h=new NLG.ts(c,e);h.$T_0=new NLG.fb(this.$4_0);h.$T_0.$e_0(this.$2K_0,this.$2J_0[d]);Array.add(i,h);a=a.substr(e);c+=e}else{a=a.substr(1);c+=1}}return i},$2z_0:function(h){for(var b=new Array(0),a=new Array(0),e=h,g=e.length,c=0;c<g;++c){var d=e[c],f=this.$3C_0(d);if(f==="EOP"){if(a.length>0){Array.add(b,a);a=new Array(0)}}else if(f==="EOS"){Array.add(a,d);Array.add(b,a);a=new Array(0)}else Array.add(a,d)}a.length>0&&Array.add(b,a);return b},$3C_0:function(a){return a.$T_0.$J_0(this.$2K_0)},$4_0:null,$2K_0:0,$1h_0:null,$2J_0:null};NLG.ex=function(){};NLG.ex.$O=function(a){return Error.invalidOperation(a)};NLG.ex.$8=function(a){return Error.argument(a)};NLG.ex.$t=function(a){return Error.argumentNull(a)};NLG.ex.$6=function(){return Error.notImplemented()};NLG.ex.$2v=function(){return Error.create("Processing Timeout")};NLG.PlainTextConverter=function(){};NLG.PlainTextConverter.getLastMessage=function(a,d){var b=window.Microsoft_NaturalLanguage_AttachmentRes[d];if(!b)return a;var e=b.lastMessage.exec(a),c=e;if(c)a=a.substr(0,c.index);return a};NLG.PlainTextConverter.getPlainText=function(d){var e=document.createElement("div"),a=$(e);a.html(NLG.PlainTextConverter.$3M(d));a.find("style").remove();a.find("script").remove();var b=a.find("br");b.size()>0&&b.replaceWith("\n");var c=a.find("p");c.size()>0&&c.append("\n");var f=a.text().trim();return f};NLG.PlainTextConverter.$3M=function(a){var d="",b=0,c=a.indexOf("<!--");while(c>0){d+=a.substr(b,c);var e=a.indexOf("-->",c);b=e+3;c=a.indexOf("<!--",b)}d+=a.substr(b);return d};Type.registerNamespace("NLG.FAD");NLG.FAD.res=function(){};NLG.FAD.AttachmentSentence=function(){};NLG.FAD.AttachmentSentence.prototype={startIndex:0,length:0};NLG.FAD.AttachmentResult=function(){};NLG.FAD.AttachmentResult.prototype={hasAttachment:false,ruleNumber:0,sentences:null};NLG.FAD.InternalAttachmentResult=function(){this.$d_0=new NLG.FAD.AttachmentResult;this.$1E_0=0};NLG.FAD.InternalAttachmentResult.prototype={$1I_0:false};NLG.FAD.ForgottenAttachmentDetector=function(){};NLG.FAD.ForgottenAttachmentDetector.$3J=function(c){var a=new NLG.FAD.res;a.$32_0=c.culture;var b=new NLG.of(c.grammar);a.$z_0=b.$34_0("Main");a.$1u_0=b.$2_0.$1W_0("FAD_Schema.AttachmentBoost");a.$1w_0=b.$2_0.$1W_0("FAD_Schema.AttachmentBoostSubject");a.$1v_0=b.$2_0.$1W_0("FAD_Schema.AttachmentBoostFeatures");a.$2P_0=b.$2_0.$1W_0("FAD_Schema.RuleName");if(!a.$z_0||!a.$z_0.$1s_0||a.$1u_0<0||a.$1w_0<0||a.$1v_0<0||a.$2P_0<0)return null;return a};NLG.FAD.ForgottenAttachmentDetector.$39=function(a){if(NLG.FAD.ForgottenAttachmentDetector.$1d[a])return NLG.FAD.ForgottenAttachmentDetector.$1d[a];if(typeof window.Microsoft_NaturalLanguage_AttachmentRes!=="undefined"){var b=window.Microsoft_NaturalLanguage_AttachmentRes[a];if(b){var c=NLG.FAD.ForgottenAttachmentDetector.$3J(b);NLG.FAD.ForgottenAttachmentDetector.$1d[a]=c;return c}}return null};NLG.FAD.ForgottenAttachmentDetector.prototype={maxtx:2e3,maxtm:200,tmr:false,pas:false,hasAttachments:function(b,f){this.tmr=false;var c=new NLG.FAD.AttachmentResult,a=new NLG.FAD.InternalAttachmentResult,g=(new Date).getTime()+this.maxtm;if(!b||null===f)return c;var d=NLG.FAD.ForgottenAttachmentDetector.$39(f);if(!d)return c;if(null===b.body&&null===b.subject)return c;var e=null,h=null;if(null!==b.subject)e=b.subject.substr(0,this.maxtx);if(null!==b.body)h=b.body.substr(0,this.maxtx);if(e){a.$1I_0=true;this.$2o_0(e,d,g,a);if(a.$1E_0===-3)return c;else if(a.$d_0.hasAttachment)return a.$d_0}a.$1I_0=false;this.$2o_0(h,d,g,a);return a.$d_0},$2o_0:function(e,c,q,a){if(null===e)return;for(var j=c.$z_0.$1s_0.$2z_0(c.$z_0.$1s_0.$2w_0(e,0,e.length)),p=j.length,i=j,o=i.length,f=0;f<o;++f){var b=i[f];try{var d=c.$z_0.$3I_0(e,0,e.length,b,q);if(!d)continue;if(a.$1I_0){var l=d.$J_0(c.$1w_0);if(null!==l){a.$1E_0=l;if(a.$1E_0===-3||a.$1E_0<0)return}}var k=d.$J_0(c.$1u_0),g=null;if(!a.$1I_0)g=d.$J_0(c.$1v_0);if(null!==k&&k===1||p===1&&!a.$1I_0&&null!==g&&g===1&&a.$1E_0!==1){var m=d.$J_0(c.$2P_0);if(null!==m){a.$d_0.ruleNumber=m;a.$d_0.hasAttachment=true;if(!a.$d_0.sentences)a.$d_0.sentences=new Array(0);var h=new NLG.FAD.AttachmentSentence;h.startIndex=b[0].$3_0;h.length=b[b.length-1].$3_0+b[b.length-1].$A_0-b[0].$3_0;a.$d_0.sentences[a.$d_0.sentences.length]=h;if(!this.pas)return}}}catch(n){if(n.message==="Processing Timeout")this.tmr=true;return}}}};NLG.EmailData.registerClass("NLG.EmailData");NLG.ts.registerClass("NLG.ts");NLG.ri.registerClass("NLG.ri");NLG.rem.registerClass("NLG.rem");NLG.cr.registerClass("NLG.cr");NLG.sim.registerClass("NLG.sim");NLG.a.registerClass("NLG.a");NLG.fb.registerClass("NLG.fb");NLG.sv.registerClass("NLG.sv");NLG.lv.registerClass("NLG.lv");NLG.snr.registerClass("NLG.snr",null,NLG.inr);NLG.aq.registerClass("NLG.aq");NLG.aq.c.registerClass("NLG.aq.c");NLG.as.registerClass("NLG.as");NLG.cg.registerClass("NLG.cg");NLG.f.registerClass("NLG.f");NLG.f.t.registerClass("NLG.f.t");NLG.iu.registerClass("NLG.iu");NLG.of.registerClass("NLG.of");NLG.renr.registerClass("NLG.renr",null,NLG.inr);NLG.bfm.registerClass("NLG.bfm");NLG.bfm.m.registerClass("NLG.bfm.m");NLG.bfm.c.registerClass("NLG.bfm.c");NLG.bfm.e.registerClass("NLG.bfm.e");NLG.bfm.s.registerClass("NLG.bfm.s");NLG.nfa.registerClass("NLG.nfa");NLG.nfa.s.registerClass("NLG.nfa.s");NLG.sre.registerClass("NLG.sre");NLG.sre.w.registerClass("NLG.sre.w");NLG.tk.registerClass("NLG.tk");NLG.ex.registerClass("NLG.ex");NLG.PlainTextConverter.registerClass("NLG.PlainTextConverter");NLG.FAD.res.registerClass("NLG.FAD.res");NLG.FAD.AttachmentSentence.registerClass("NLG.FAD.AttachmentSentence");NLG.FAD.AttachmentResult.registerClass("NLG.FAD.AttachmentResult");NLG.FAD.InternalAttachmentResult.registerClass("NLG.FAD.InternalAttachmentResult");NLG.FAD.ForgottenAttachmentDetector.registerClass("NLG.FAD.ForgottenAttachmentDetector");NLG.cg.$2Q=new Array(0);NLG.iu.$1O=-2147483648;NLG.bfm.$1o=[new NLG.bfm.m];NLG.bfm.$2u=new NLG.rem(new NLG.sim(new Array(0),""),0,0,0,0);NLG.nfa.$33=NLG.iu.$1O;NLG.nfa.$23=NLG.iu.$1O;NLG.nfa.$2b=NLG.iu.$1O;NLG.nfa.$24=NLG.iu.$1O;NLG.nfa.$1z=-1;NLG.nfa.$2n=4194303;NLG.FAD.ForgottenAttachmentDetector.$1d={};
window.scriptsLoaded['microsoft.naturallanguage.clientruntime.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.naturallanguage.clientruntime.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
