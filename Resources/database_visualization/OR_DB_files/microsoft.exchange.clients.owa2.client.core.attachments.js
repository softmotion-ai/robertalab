try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.exchange.clients.owa2.client.core.attachments.js'] = (new Date()).getTime();
Type.registerNamespace("_at");_at.$1D8=function(n,t,i,r){_at.$1D8.initializeBase(this);this.$5i=n;this.$1ZQ=t;this.$3D=i;this.$ML=r};_at.$1D8.prototype={$1ZQ:null,$3D:null,$ML:null,$5i:null,$3Fg:null,$6OX:function(n){var t=new _g.$1D9(this.$2k);n.$5tv(this.$5i,this.$1ZQ,this.$3D,this.$ML,t,this.$$d_$6qk,this.$$d_$1N0)},$6vq:function(n,t,i){try{_a.$4.$1s(n,"result");this.$3Fg=n;t()}catch(r){i(r)}}};function AttachmentsComponent(){}AttachmentsComponent.prototype={$2FV:function(n,t,i){var r=n.$2(_g.$O).get_$2dr();if(t.get_$8b()){var e=this;n.$r(_at.$Vp).$1I().$t(function(){var t=_bc.$Og.isInstanceOfType(_g.$1H.$1Q)?_g.$1H.$1Q:null;return new _at.$4Z(n.$2(_a.$3G),t?t.get_$4R().get_$2E6():null,t?t.get_$A8G():null)})}else{var o=this;n.$r(_at.$Vp).$1I().$t(function(){return new _at.$1Pd})}var u=this;n.$r(IAttachmentViewModelFactory).$t(function(){return new _at.$1BA(n.$2(IInferenceTracker),n.$2(_y.$W),n.$2(_at.$Vp),n.$2(_a.$t),n.$2(_a.$3G),n.$36(IAttachmentProviderItemViewModelFactory),n.$2(_a.$1d),n.$36(IAttachmentPreviewViewModelFactory),n.$36(IItemStoreGetterFactory),n.$2(IUriFileAttachmentViewModelFactory),n.$3K(ISmimeCommandFactory),n.$2(_a.$I9),r)});var f=this;n.$r(_at.$19o).$2a(IUriFileAttachmentViewModelFactory).$1I().$t(function(){return new _at.$19o(n.$2(_a.$Oe),n.$2(_a.$2Y),n.$2(IInferenceTracker),n.$2(_a.$1d),n.$36(IAttachmentPreviewViewModelFactory),n.$36(IItemStoreGetterFactory),n.$3K(ISmimeCommandFactory),n.$2(_a.$I9),r,n.$2(_a.$3G))})},$Bl5:function(){return null}};_at.$4v=function(n){this.$$d_$6Jz=Function.createDelegate(this,this.$6Jz);this.$$d_$7p9=Function.createDelegate(this,this.$7p9);this.$$d_$Ez2=Function.createDelegate(this,this.$Ez2);this.$$d_$Ez3=Function.createDelegate(this,this.$Ez3);this.$$d_$ByM=Function.createDelegate(this,this.$ByM);_at.$4v.initializeBase(this,[n]);this.set_$Br("about:blank");this.set_$g(-1);this.get_$S().load(this.$$d_$ByM)};_at.$4v.prototype={$1Ru:null,$Ze:null,$Bs:0,$4yO:!1,$2H:null,$qZ:0,$4J8:null,$4Ur:!1,$5ff:null,get_$9P:function(){return this.$w(_at.$4v.$5mf)},set_$9P:function(n){this.$P(_at.$4v.$5mf,n);return n},get_$F7:function(){return this.$w(_at.$4v.$6sW)},set_$F7:function(n){this.$P(_at.$4v.$6sW,n);return n},set_$2t:function(n){n||(this.$Bs=-1);this.$P(_at.$4v.$2No,n);return n},get_$4eS:function(){return this.$w(_at.$4v.$637)},set_$4eS:function(n){this.$P(_at.$4v.$637,n);return n},get_$3eU:function(){return this.$w(_at.$4v.$5fg)},set_$3eU:function(n){this.$P(_at.$4v.$5fg,n);return n},set_$9wr:function(n){if(this.$5ff===n)return n;this.$5ff=n;this.$4("UploadAndShareAttachmentCommand");return n},get_$5fh:function(){return this.$w(_at.$4v.$7Ny)},set_$5fh:function(n){this.$P(_at.$4v.$7Ny,n);return n},set_$Kt:function(n){this.$2H=n;this.$4("Error");return n},set_$32Q:function(n){this.$qZ=n;this.$4("AttachmentError");return n},set_$5az:function(n){this.$4J8=n;this.$4("SuccessResponse");return n},$8j:function(){_js.$F.prototype.$8j.call(this);this.$P(_at.$4v.$5fg,new _C(this.$$d_$Ez3,_at.$4v.$L));this.set_$9wr(new _C(this.$$d_$Ez2,_at.$4v.$L))},$ByM:function(n){if(this.$Bs){if(this.$Bs===2){_js.Trace.logInfo(_at.$4v.$L,"Response received.");var t="";try{t=this.get_$S()[0].contentWindow.document.body.innerText}catch(u){if(!(_a.UserAgent.getInstance().$Ec&&u.number===-2146828218)){_js.Trace.logException(_at.$4v.$L,u,"Unhandled exception while executing HandleCreateAttachmentResponse");return}}if(this.$4yO)_js.$9.$o(t)&&this.$6ov(null,"Error sending the attachment upload form",1);else{var r=this,i=this;_at.$Cu.$Bxh(t,this.get_$9P(),this.get_$F7(),_g.$1H.$1Q,function(n){_js.Trace.logInfo(_at.$4v.$L,"HandleCreateAttachmentResponse completed.");r.$6ov(n,null,0)},function(n,t){_js.Trace.logInfo(_at.$4v.$L,"HandleCreateAttachmentResponse failed: {0}",n.message);var r=1;if(n.ResponseCode){var u=n.ResponseCode.toString();i.get_$9P().get_$CA()&&u==="ErrorInvalidOperation"?r=4:u==="ErrorMessageSizeExceeded"&&(r=3)}var f=_at.$6b.$8Es(t)||_at.$6b.$3sd(n);i.$6ov(null,f,r)})}}}else{_js.Trace.logInfo(_at.$4v.$L,"Initializing.");this.$Bs=1;this.$C50();_js.$D.get_$Q().$2V(_at.$4v.$L,"ExecuteOpenFilePicker",this.$$d_$7p9,0)}},$6ov:function(n,t,i){this.set_$5az(n);this.set_$Kt(t);this.set_$32Q(i);this.$Bs=3;this.get_$5fh().$11();this.$4Ur=!1},$C50:function(){var n=this.get_$S()[0];n.contentWindow.document.body.innerHTML="";this.$1Ru=n.contentWindow.document.createElement("form");this.$1Ru.method="POST";this.$1Ru.encType="multipart/form-data";this.$1Ru.encoding="multipart/form-data";this.$A2s(this.$1Ru);this.$Ze=$(n.contentWindow.document.createElement("input"));this.$Ze.attr("type","file");this.$Ze.attr("name","fileInput");var t=this;this.$Ze.change(function(n){t.$6Jz()});_a.UserAgent.getInstance().$Ec&&this.$Ze[0].attachEvent("onchange",this.$$d_$6Jz);this.$1Ru.appendChild(this.$Ze[0])},$A2s:function(n){this.get_$S()[0].contentWindow.document.body.appendChild(n)},$6Jz:function(){if(!this.$4Ur){this.$4Ur=!0;var n=this.$Ze[0].value;if(!_js.$9.$o(n)){this.get_$9P().set_$1x(this.$EqW(n));this.get_$4eS().$11()}}},$EqW:function(n){var t=n.lastIndexOf("\\");return n.substr(t+1)},$7p9:function(){this.$Ze[0].click()},$Ez3:function(){this.$4yO=!1;this.$1Ru.action=_g.$3U.get_$7Wr();this.$7p2()},$Ez2:function(){this.$4yO=!0;this.$1Ru.action=_g.$3U.get_$A8K();this.$30p("subscriptionId",this.get_$k().get_$VW());this.$7p2()},$7p2:function(){_js.Trace.logInfo(_at.$4v.$L,"Uploading attachment via form submit.");this.$30p("parentItemId",this.get_$F7().Id);this.$30p("parentChangeKey",this.get_$F7().ChangeKey);this.$30p("isInline",this.get_$9P().get_$CA().toString());this.$30p("cancellationId",this.get_$k().get_$1C6());this.$30p(_a.$2D.$1nT(),_a.$2D.$224());this.$1Ru.submit();this.$Bs=2},$30p:function(n,t){var i=$(this.$1Ru.ownerDocument.createElement("input"));i.attr("type","hidden");i.attr("name",n);i.val(t);this.$1Ru.appendChild(i[0])}};_at.AttachmentPolicyLevel=function(){};_at.AttachmentPolicyLevel.prototype={undefined:0,block:1,forceSave:2,allow:3};_at.AttachmentPolicyLevel.registerEnum("_at.AttachmentPolicyLevel",!1);_at.$1VO=function(){};_at.$1VO.registerInterface("_at.$1VO");_at.$64=function(n,t){this.$CY=n||_at.$64.$Buf();this.$3ak=t;this.$1RC=this.$3ak?this.$CY.DirectFileAccessOnPublicComputersEnabled:this.$CY.DirectFileAccessOnPrivateComputersEnabled;if(this.$1RC){this.$63A=_at.$64.$7iW(this.$CY.BlockedFileTypes,this.$CY.ForceSaveFileTypes,this.$CY.AllowedFileTypes);this.$6kz=_at.$64.$7iW(this.$CY.BlockedMimeTypes,this.$CY.ForceSaveMimeTypes,this.$CY.AllowedMimeTypes)}this.$6uG=_at.$64.$AK0(this.$CY.ActionForUnknownFileAndMIMETypes)};_at.$64.get_$Q=function(){_at.$64.$1Q||(_at.$64.$1Q=new _at.$64(_g.$O.get_$Q().get_$2dr(),_g.$O.get_$Q().get_$Ecl()));return _at.$64.$1Q};_at.$64.$AK0=function(n){var t;try{t=_js.$1I.$Ba(_at.AttachmentPolicyLevel,n)}catch(i){t=1}return t};_at.$64.$8Hd=function(n,t){return n[t]||0};_at.$64.$7iW=function(n,t,i){var r={};_at.$64.$5jK(r,i,3);_at.$64.$5jK(r,t,2);_at.$64.$5jK(r,n,1);return r};_at.$64.$5jK=function(n,t,i){if(t)for(var u=t,e=u.length,r=0;r<e;++r){var f=u[r];n[f]=i}};_at.$64.$Buf=function(){var n=new _g.$ZJ;return JsonParser.deserialize('{"AllowedFileTypes":[".rpmsg", ".xlsx", ".xlsm", ".xlsb", ".tiff", ".pptx", ".pptm", ".ppsx", ".ppsm", ".docx", ".docm", ".zip", ".xls", ".wmv", ".wma", ".wav", ".vsd", ".vss", ".vst",  ".vdx", ".vsx", ".vtx", ".vsdx", ".vssx", ".vstx", ".vsdm", ".vssm", ".vstm",".txt", ".tif", ".rtf", ".pub", ".ppt", ".png", ".pdf", ".one", ".mp3", ".jpg", ".gif", ".doc", ".bmp", ".avi"],"AllowedMimeTypes":["image/jpeg", "image/png", "image/gif", "image/bmp"],"ForceSaveFileTypes":[".swf", ".spl", ".dir", ".dcr"],"ForceSaveMimeTypes":["Application/x-shockwave-flash", "Application/octet-stream", "Application/futuresplash", "Application/x-director"],"BlockedFileTypes":[".vsmacros", ".msh2xml", ".msh1xml", ".ps2xml", ".ps1xml", ".mshxml", ".gadget", ".mhtml", ".psc2", ".psc1", ".msh2", ".msh1", ".aspx", ".xml", ".wsh", ".wsf", ".wsc", ".vsw", ".vbs", ".vbp", ".vbe", ".url", ".tmp", ".shs", ".shb", ".sct", ".scr", ".scf", ".reg", ".pst", ".ps2", ".ps1", ".prg", ".prf", ".plg", ".pif", ".pcd", ".osd", ".ops", ".mst", ".msp", ".msi", ".msh", ".msc", ".mht", ".mdz", ".mdw", ".mdt", ".mde", ".mdb", ".mda", ".maw", ".mav", ".mau", ".mat", ".mas", ".mar", ".maq", ".mam", ".mag", ".maf", ".mad", ".lnk", ".ksh", ".jse", ".its", ".isp", ".ins", ".inf", ".htc", ".hta", ".hpj", ".hlp", ".fxp", ".exe", ".der", ".csh", ".crt", ".cpl", ".com", ".cnt", ".cmd", ".chm", ".cer", ".bat", ".bas", ".asx", ".asp", ".app", ".adp", ".ade", ".ws", ".vb", ".js"],"BlockedMimeTypes":["application/x-javascript", "application/javascript", "application/msaccess", "x-internet-signup", "text/javascript", "application/xml", "application/prg", "application/hta", "text/scriplet", "text/xml"], "ActionForUnknownFileAndMIMETypes":"ForceSave","BlockWacViewingThroughUI":false,"WacViewableFileTypes":[".doc", ".docx", ".ppt", ".pptx", "xls", ".xlsx"],"WacViewingOnPublicComputersEnabled":true,"WacViewingOnPrivateComputersEnabled":true,"ForceWacViewingFirstOnPublicComputers":false,"ForceWacViewingFirstOnPrivateComputers":false,"ForceWebReadyDocumentViewingFirstOnPublicComputers":false,"ForceWebReadyDocumentViewingFirstOnPrivateComputers":false,"DirectFileAccessOnPrivateComputersEnabled":true,"DirectFileAccessOnPublicComputersEnabled":true,"WebReadyDocumentViewingOnPublicComputersEnabled":true,"WebReadyDocumentViewingOnPrivateComputersEnabled":true,"WebReadyDocumentViewingForAllSupportedTypes":false,"WebReadyFileTypes":[".xlsx", ".pptx", ".docx", ".xls", ".rtf", ".ppt", ".pps", ".pdf", ".dot", ".doc"],"WebReadyMimeTypes":["application/vnd.openxmlformats-officedocument.presentationml.presentation", "application/vnd.openxmlformats-officedocument.wordprocessingml.document", "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet", "application/vnd.ms-powerpoint", "application/x-mspowerpoint", "application/vnd.ms-excel", "application/x-msexcel", "application/msword", "application/pdf"],"WebReadyDocumentViewingSupportedFileTypes":[".xlsx", ".pptx", ".docx", ".xls", ".rtf", ".ppt", ".pps", ".pdf", ".dot", ".doc"],"WebReadyDocumentViewingSupportedMimeTypes":["application/vnd.openxmlformats-officedocument.presentationml.presentation", "application/vnd.openxmlformats-officedocument.wordprocessingml.document", "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet", "application/vnd.ms-powerpoint", "application/x-mspowerpoint", "application/vnd.ms-excel", "application/x-msexcel", "application/msword", "application/pdf"]}')};_at.$64.$39T=function(n,t){if(!n)return!1;for(var r=n,f=r.length,i=0;i<f;++i){var u=r[i];if(u===t)return!0}return!1};_at.$64.prototype={$3ak:!1,$1RC:!1,$6uG:0,$CY:null,$63A:null,$6kz:null,$4og:function(n,t,i,r){$C(i)&&(i=!0);$C(n)||(n=n.toLowerCase());var e;e=this.$1RC?this.$BnA(n,t):1;var f=!1;var u=!1;var s=!1;var o=!1;if(i&&!r){this.$CGP(n)&&(u=!0);this.$CFU(n,t)&&(f=!0);s=this.$CB4(this.$3ak,u,f);u&&this.$CY.WacEditableFileTypes&&n&&(o=_at.$64.$39T(this.$CY.WacEditableFileTypes,n))}return new _at.$1B6(this.$1RC,e,u,f,s,o)},$BnA:function(n,t){var r=_at.$64.$8Hd(this.$63A,n);if(r===1)return 1;var i=_at.$64.$8Hd(this.$6kz,t);return i===1?1:r===2||i===2?2:r===3||i===3?3:this.$6uG},$CGP:function(n){var t=this.$3ak?this.$CY.WacViewingOnPublicComputersEnabled:this.$CY.WacViewingOnPrivateComputersEnabled;return t&&this.$F0e(n)},$CFU:function(n,t){var i=this.$3ak?this.$CY.WebReadyDocumentViewingOnPublicComputersEnabled:this.$CY.WebReadyDocumentViewingOnPrivateComputersEnabled;return i&&this.$EkF(n,t)},$CB4:function(n,t,i){return!t&&!i?!1:n?t?this.$CY.ForceWacViewingFirstOnPublicComputers:this.$CY.ForceWebReadyDocumentViewingFirstOnPublicComputers:t?this.$CY.ForceWacViewingFirstOnPrivateComputers:this.$CY.ForceWebReadyDocumentViewingFirstOnPrivateComputers},$F0e:function(n){return _at.$64.$39T(this.$CY.WacViewableFileTypes,n)},$EkF:function(n,t){if(_js.$9.$o(n)){if(!_js.$9.$o(t))return this.$CY.WebReadyDocumentViewingForAllSupportedTypes?_at.$64.$39T(this.$CY.WebReadyDocumentViewingSupportedMimeTypes,t):_at.$64.$39T(this.$CY.WebReadyMimeTypes,t)}else return this.$CY.WebReadyDocumentViewingForAllSupportedTypes?_at.$64.$39T(this.$CY.WebReadyDocumentViewingSupportedFileTypes,n):_at.$64.$39T(this.$CY.WebReadyFileTypes,n);return!1}};_at.$1B6=function(n,t,i,r,u,f){!n;this.$1RC=n;this.$1Iv=t;this.$2zp=i;this.$1ZU=r;this.$3A7=u;this.$300=f};_at.$1B6.prototype={$1Iv:0,$1RC:!1,$3A7:!1,$2zp:!1,$1ZU:!1,$300:!1,get_$4z7:function(){return this.$1ZU||this.$2zp},toString:function(){return String.format("Attachment PolicyLevel: {0}, DirectFileAccessEnabled: {1}, WAC: {2}, Stellent: {3}, ForceBrowserView: {4}, WacEdit: {5}",this.$1Iv,this.$1RC,this.$2zp,this.$1ZU,this.$3A7,this.$300)}};_at.$sv=function(){this.$32h=new FileReader};_at.$sv.prototype={$32h:null,$61w:null,get_$Kt:function(){return this.$32h.error},get_$38z:function(){return this.$61w},get_$4d:function(){return this.$32h.result},set_$9AI:function(n){this.$32h.onloadend=n;return n},$9KH:function(n){var t=n;this.$32h.readAsDataURL(t.$32g)},$5L6:function(n,t,i,r){var u=this;this.set_$9AI(function(){if(!u.get_$Kt()&&u.get_$4d()){var f=u.get_$4d().indexOf(",");var n=u.get_$4d().substring(f+1,u.get_$4d().length);_js.Trace.logInfo(r,"No error - Reading the file.");u.get_$4d().substring(0,f).indexOf("base64")!==-1?t(n):t(_a.$5u.$Jh(n))}else{_js.Trace.logWarning(r,"File reader failed with error code {0}",u.get_$Kt());i()}});try{this.$9KH(n)}catch(f){this.$61w=f;_a.UserAgent.getInstance().$a8&&f.name==="NS_ERROR_FILE_ACCESS_DENIED"?_js.Trace.logInfo(r,"Firefox: failed to read an attachment. Exception: {0}",f.message):_js.Trace.logWarning(r,"Unexpected exception was thrown by FileReader.ReadAsDataURL: "+f.message);i()}}};_at.$11n=function(){};_at.$11n.prototype={$5uP:function(){return new _at.$sv}};_at.$1CI=function(n){_at.$1CI.initializeBase(this);this.$xo=n};_at.$1CI.prototype={$xo:null,$6OX:function(n){var t=new _g.$1CJ(this.$2k);n.$4UA(this.$xo,t,this.$$d_$6qk,this.$$d_$1N0)},$6vq:function(n,t,i){n?t():i(null)}};_at.$Cu=function(n,t,i,r){_at.$Cu.initializeBase(this);this.$np=n;this.$1w=t;this.$HJ=i;this.$xo=r};_at.$Cu.$Bxh=function(n,t,i,r,u,f){try{var o=JsonParser.deserialize(n);if(o&&o.Body)if(o.Body.ResponseMessages){var s=o.Body.ResponseMessages.Items[0];if(s.ResponseCode!=="NoError"){_js.Trace.logError(_at.$Cu.$L,"Got a attachment error response with {0}",s.ResponseCode);var l=s.MessageText;var h={};h.ResponseCode=s.ResponseCode;f(Error.create(l,h),null)}else{var e=s.Attachments[0];t.set_$6J(e.AttachmentId);i.Id=e.AttachmentId.RootItemId;i.ChangeKey=e.AttachmentId.RootItemChangeKey;t.set_$8D(e.Size||0);t.set_$KN(e.ContentType);t.get_$CA()&&t.set_$SF(e.ContentId);u(o)}}else{_js.Trace.logError(_at.$Cu.$L,"Got no response message in the body; assuming it is a fault response");var c=o;f(Error.create(c.Body.FaultMessage),c.Body)}else{_js.Trace.logError(_at.$Cu.$L,"Got no response or response without body");f(Error.create(""),null)}}catch(a){_js.Trace.logError(_at.$Cu.$L,"Got exception processing response: {0}, exception: {1}",n,a);n===""&&(a=Error.create(""));f(a,null)}};_at.$Cu.$9IL=function(n,t,i){if(!n.IsCancelled){t.set_$6J(n.Attachments[0].AttachmentId);t.get_$CA()&&t.set_$SF(n.Attachments[0].ContentId);n.Attachments[0].Size>0&&t.set_$8D(n.Attachments[0].Size);i.Id=n.Attachments[0].AttachmentId.RootItemId;i.ChangeKey=n.Attachments[0].AttachmentId.RootItemChangeKey}};_at.$Cu.prototype={$np:0,$1w:null,$HJ:null,$Ce:null,$xo:null,$BuK:function(){if(this.$2H||!this.$68||!this.$68.response){_js.Trace.logInfo(_at.$Cu.$L,"No success response because there's an error, or action is not complete.  Error: {0}",this.$2H);return null}return this.$68.response.result},$6OX:function(n){this.$Ce=this.$u4();var i=new _g.$10d(this.$2k);if(this.$xo){var t=new _g.$1D7(this.$2k);t.clientStoreItem=this.$np;t.isQueued=!1;t.palContext=new _g.$oD(!1);n.$5tu(this.$Ce,t,this.$$d_$6qk,this.$$d_$1N0)}else{i.clientStoreItem=this.$np;i.isQueued=!1;i.palContext=new _g.$oD(!1);n.$2Fl(this.$Ce,i,this.$$d_$6qk,this.$$d_$1N0)}},$wV:function(n){this.$9IM(n)},$9IM:function(n){_at.$Cu.$9IL(n,this.$1w,this.$HJ)},$u4:function(){var i=new _g.$1T(this.$HJ.Id);i.ChangeKey=this.$HJ.ChangeKey;var t=this.$1w.$3sG();var n=new _g.$UE(i);n.Attachments=[t];n.RequireImageType=t.IsInline;n.IncludeContentIdInResponse=t.IsInline;n.ClientSupportsIrm=!0;n.CancellationId=this.$xo;return new _g.$UD(this.get_$7h(),n)}};_at.$1DA=function(n,t,i,r){_at.$1DA.initializeBase(this,[n,t,i,r]);var u=t.$LJ;this.$5wq=u};_at.$1DA.prototype={$5wq:null,$6OX:function(n){var u=this.$u4();var t=new _g.$10d(this.$2k);t.clientStoreItem=this.$np;t.isQueued=!0;for(var r=u.Body.Attachments,e=r.length,i=0;i<e;++i){var f=r[i];if(f.IsInline){t.isQueued=!1;break}}t.palContext=new _g.$oD(!0);t.dataFile=this.$5wq.$TY();n.$2Fl(u,t,this.$$d_$6qk,this.$$d_$1N0)},$wV:function(n){this.$9IM(n)}};_at.$1Dg=function(n,t,i){_at.$1Dg.initializeBase(this);this.$np=n;this.$1w=t;this.$HJ=i;this.$D3=t.get_$6J()||t.get_$az()};_at.$1Dg.prototype={$np:0,$1w:null,$D3:null,$HJ:null,$wV:function(n){this.$HJ.Id=n.RootItemId.RootItemId;this.$HJ.ChangeKey=n.RootItemId.RootItemChangeKey;this.$1w.get_$az()&&this.$1w.set_$6J(this.$1w.get_$az())},$6OX:function(n){var r=new _g.$UK;r.ClientSupportsIrm=!0;var i=new _g.$1Dh(this.$2k);i.itemContexts=new Array(1);var t=new _g.$1Di;t.clientStoreItem=this.$np;t.parentItemId=new _g.$1T(this.$HJ.Id);t.parentItemId.ChangeKey=this.$HJ.ChangeKey;r.AttachmentIds=[new _g.$DC(this.$D3.Id)];var u=new _g.$al(this.get_$7h());u.Body=r;i.itemContexts[0]=t;n.$2g4(u,i,this.$$d_$6qk,this.$$d_$1N0)}};_at.$V0=function(n){_at.$V0.initializeBase(this);this.$384=_a.$6.$1g(_at.$V0.$L,"DownloadAttachment");this.$D3=n};_at.$V0.prototype={$D3:null,$365:null,$384:null,$6OX:function(n){var i=new _g.$1Fe(this.$2k);var t=new _g.$c7(this.get_$7h());t.Body.AttachmentIds=[new _g.$DC(this.$D3)];t.Body.ShapeName="ItemAttachment";t.Body.AttachmentShape=_h.$f.get_$CGa();n.$6FZ(t,i,this.$$d_$6qk,this.$$d_$1N0)},$wV:function(n){var u=n.Attachments.length;if(u!==1){var f=String.format("GetAttachment response length = {0}",u);_a.$6.$1G(this.$384,"DownloadAttachment",f);_js.Trace.logWarning(_a.$0.$1m,f);return}var e=n.Attachments[0];if(!e){var t="GetAttachment response contained null attachment";_a.$6.$1G(this.$384,"DownloadAttachment",t);_js.Trace.logWarning(_a.$0.$1m,t);return}var i=_a.$1A.$C5(_g.$7d,e);this.$365=i.get_$E();if(!this.$365){var r="GetAttachment response contained null item";_a.$6.$1G(this.$384,"DownloadAttachment",r);_js.Trace.logWarning(_a.$0.$1m,r);return}_js.Trace.logInfo(_a.$0.$1m,"GetAttachment succeeded for '{0}' on '{1}'",i.get_$1x(),this.$365.get_$3o());_a.$6.$1G(this.$384,"DownloadAttachment")}};_at.$1Fd=function(n,t){_at.$1Fd.initializeBase(this);this.$2D=n;this.$1w=t;this.$D3=t.get_$6J()||t.get_$az();if(!_g.$54.isInstanceOfType(t)&&!_g.$7d.isInstanceOfType(t)&&!_g.$7S.isInstanceOfType(t))throw Error.notImplemented("Only FileAttachment, ItemAttachment and ItemIdAttachment are supported to get content.");};_at.$1Fd.prototype={$2D:null,$1w:null,$D3:null,$98C:function(){if(_g.$54.isInstanceOfType(this.$1w)){var n=this.$1w;if(_a.$1Iw.isInstanceOfType(n.$LJ)){var u=n.$LJ;var r=new _at.$11n;var f=r.$5uP();var t=this,i=this;f.$5L6(u,function(i){n.set_$DY(t.$64s(i));t.$Ph(null)},function(){var t=String.format("Unable to read content of file {0}.",n.get_$1x());_js.Trace.logWarning(i.$2D,t);i.$Ph(Error.create(t))},this.$2D);return 1}else return this.$8F1()}else return _g.$7d.isInstanceOfType(this.$1w)?this.$8F1():_h.$1az.prototype.$98C.call(this)},$6vq:function(n,t,i){var r=this.$1w;if(_js.$9.$o(n))i(Error.create(String.format("The MIME content of item {0} cannot be retrieved.",r.get_$y().Id)));else{r.set_$c5(this.$64s(n));t()}},$6OX:function(n){var t=new _g.$1T(this.$1w.get_$y().Id);n.$6HN(t,null,this.$$d_$6qk,this.$$d_$1N0)},$8F1:function(){var t=new XMLHttpRequest;var i=String.format(_g.$7d.isInstanceOfType(this.$1w)?_g.$3U.get_$32P():_g.$3U.get_$7Wo(),encodeURIComponent(this.$D3.Id));var n=this;t.onreadystatechange=function(){if(t.readyState===4)if(t.status===200){var r=n.$64s(t.responseText);_g.$54.isInstanceOfType(n.$1w)?n.$1w.set_$DY(r):_g.$7d.isInstanceOfType(n.$1w)&&n.$1w.set_$c5(r);n.$Ph(null)}else{var i=String.format("Unable to get file attachment content.\nAttachmentId = {0}\nResponseBody = {1}\nStatusText = {2}",n.$D3.Id,t.responseText,t.statusText);_js.Trace.logError(n.$2D,i);n.$Ph(Error.create(i))}};t.open("GET",i,!0);_a.$b.$9nP(t);t.send(null);return 1},$64s:function(n){if(n.startsWith("data:")){var t=";base64,";var i=n.indexOf(t);return n.substr(i+t.length)}else return n}};var IAttachmentDataProviderMap=function(){};IAttachmentDataProviderMap.registerInterface("IAttachmentDataProviderMap");_at.$1VN=function(){};_at.$1VN.registerInterface("_at.$1VN");var IAttachmentPreviewViewModelFactory=function(){};IAttachmentPreviewViewModelFactory.registerInterface("IAttachmentPreviewViewModelFactory");_at.$Vp=function(){};_at.$Vp.registerInterface("_at.$Vp");_at.$1VM=function(){};_at.$1VM.registerInterface("_at.$1VM");_at.$AS=function(n,t,i,r,u){this.$Y0=_js.$9.$o(n)?"#":n;this.$gA=t;this.$Ls=i;this.$8A=r;this.$8WJ=u;this.$3V=u?_nbs.NonBootStrings.l_OpenInBrowser_Text:_nbs.NonBootStrings.l_Download_Text;_js.Trace.logInfo(_a.$0.$1m,'AttachmentDownloadLinkViewModel isHidden={0}, preventNavigation={1}, text="{2}", URL={3}',this.$8A,this.$gA,this.$3V,this.$Y0)};_at.$AS.get_$8MZ=function(){_at.$AS.$4qs||(_at.$AS.$4qs=new _at.$AS("#",!0,null,!0,!1));return _at.$AS.$4qs};_at.$AS.$9=function(n,t,i){_a.$4.$X(n,"viewModel");_a.$4.$X(i,"owaShell");var r;var f;var u;if(t){var h,c,l;_at.$AS.$ACA(n,h={val:f},c={val:r},l={val:u}),f=h.val,r=c.val,u=l.val}else{var e,o,s;_at.$AS.$7Z3(n,e={val:f},o={val:r},s={val:u}),f=e.val,r=o.val,u=s.val}if(_at.$34.isInstanceOfType(n)){var a=n;a.$sd.get_$1QE()&&(r=!0)}return new _at.$AS(f,r,u,!1,t)};_at.$AS.$7Z3=function(n,t,i,r){var u=!1;if(_at.$34.isInstanceOfType(n)){var f=n;u=f.$sd.get_$1QE()}if(!n.$PG.$1RC||u||n.$PG.$3A7||n.$1w.get_$X8()){i.val=!0;t.val="#";r.val=n.$19t;return}switch(n.$PG.$1Iv){case 3:i.val=!1;t.val=n.$Y0;r.val=n.$7CV;break;case 2:i.val=!0;r.val=n.$19t;t.val=n.$Y0;break;case 1:i.val=!0;t.val="#";r.val=n.$19t;break;case 0:default:i.val=!0;t.val="#";r.val=n.$19t;break}};_at.$AS.$ACA=function(n,t,i,r){if(n.$1w.get_$X8()){i.val=!0;t.val="#";r.val=n.$19t;return}switch(n.get_$HO()){case 5:i.val=!0;t.val="#";r.val=n.$6qu;break;case 3:i.val=!0;t.val="#";r.val=n.$27z;break;case 1:case 2:i.val=!0;t.val="#";r.val=n.$PG.$1Iv===3?new _C(function(){n.$9h&&n.$9h.$EeU(n)},_a.$0.$1m):n.$19t;break;default:_at.$AS.$7Z3(n,t,i,r);break}};_at.$AS.prototype={$gA:!1,$Y0:null,$Ls:null,$3V:null,$8A:!1,$8WJ:!1};_at.$r4=function(n,t,i,r,u){_at.$r4.initializeBase(this,[_at.$r4.$3EH(),"AttachmentUploadDatapoint"]);this.$P("S",n);this.$P("T",t.toString());this.$P("E",i);this.$P("X",r);this.$P("Z",u.toString())};_at.$r4.$3EH=function(){return 1};_at.$GS=function(){};_at.$GS.$$cctor=function(){_at.$GS.$3hd={}};_at.$GS.$A2M=function(n){if(n){var t=_a.$5V.$4o(n);var i=t.$ZB.toString();_at.$GS.$3hd[i]=t}};_at.$GS.$A2L=function(n,t,i,r){if(n){var u=n;var f=u.$ZB.toString();u=_at.$GS.$3hd[f];if(u){_at.$GS.$3hd[f]=null;u.$328();var e=new _at.$r4(u.$3D,u.$1dJ,t,i,r);_a.$i.$qs.$JY(e)}}};_at.$1j=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){this.$$d_$634=Function.createDelegate(this,this.$634);this.$$d_$749=Function.createDelegate(this,this.$749);this.$$d_$ACx=Function.createDelegate(this,this.$ACx);this.$$d_$ACy=Function.createDelegate(this,this.$ACy);this.$$d_$35J=Function.createDelegate(this,this.$35J);this.$$d_$4X7=Function.createDelegate(this,this.$4X7);this.$$d_$5xl=Function.createDelegate(this,this.$5xl);this.$$d_$AUk=Function.createDelegate(this,this.$AUk);this.$$d_$7Wv=Function.createDelegate(this,this.$7Wv);this.$$d_$Ez7=Function.createDelegate(this,this.$Ez7);this.$$d_$ALH=Function.createDelegate(this,this.$ALH);this.$$d_$DXk=Function.createDelegate(this,this.$DXk);this.$$d_$2g4=Function.createDelegate(this,this.$2g4);this.$$d_$DnZ=Function.createDelegate(this,this.$DnZ);this.$$d_$WU=Function.createDelegate(this,this.$WU);this.$$d_$5GL=Function.createDelegate(this,this.$5GL);this.$$d_$EZ9=Function.createDelegate(this,this.$EZ9);this.$$d_$4bk=Function.createDelegate(this,this.$4bk);this.$$d_$aV=Function.createDelegate(this,this.$aV);this.$636=new _at.$11n;_at.$1j.resolveInheritance();this.apcl=this.$p;this.rpcl=this.$1B;_at.$1j.initializeBase(this);this.$2Y=f;this.$1D=o;this.$1Bq=s;this.$Pi=h;this.$6R=c;this.set_$9P(n);this.$I=t;this.set_$Dos(u);this.$1E=e;this.$Mm_4=a;this.$l_4=y;_g.$54.isInstanceOfType(n)&&(this.$yN=n.get_$DY());u&&(this.$99=u.get_$1ao());this.$7u=i;this.$Dg=r;this.$CY=v;this.set_$1J6(!this.$7u);this.set_$7q6(_a.$69.$li(n.get_$1x()));this.set_$9Gq(_at.$64.get_$Q().$4og(this.$1Js,this.$1w.get_$KN(),_y.$6k.$6Uc(this.$I,this.$1E),this.get_$3Jo()));this.$1w&&this.$1w.get_$6J()&&this.set_$3Sh(this.$PG.get_$4z7());this.$4Kt();this.$3eM();this.$9vU();this.$9wJ();this.$7NC();this.$19t=new _C(this.$$d_$aV,_at.$1j.$L);this.$1zK=new _C(this.$$d_$4bk,_at.$1j.$L);this.$7CV=new _C(this.$$d_$EZ9,_at.$1j.$L);this.$6qu=new _C(this.$$d_$5GL,_at.$1j.$L);this.$27z=new _C(this.$$d_$WU,_at.$1j.$L);this.$6Y1=new _C(this.$$d_$DnZ,_at.$1j.$L);if(!this.get_$C93()){this.$IC=new _C(this.$$d_$2g4,_at.$1j.$L);this.$47i=new _C(this.$$d_$DXk,_at.$1j.$L);this.$47l=new _C(this.$$d_$ALH,_at.$1j.$L)}this.$Qa=new _y.$NJ;this.$Bq=l;this.$3e5();this.$wb()};_at.$1j.prototype={$19t:null,$1zK:null,$7CV:null,$6qu:null,$27z:null,$IC:null,$47i:null,$47l:null,$6Y1:null,$Qa:null,$7u:!1,$Dg:!1,$I:null,$1E:null,$l_4:null,$99:null,$1D:null,$1Bq:null,$2Y:null,$1w:null,$Y0:null,$3K2:!1,$2ef:!1,$4SC:!1,$7O0:!1,$6qs:!1,$PG:null,$9h:null,$3p:!1,$qE:!1,$3c5:null,$5ai:null,$1jH:0,$1lh:null,$2Ib:0,$3eV:null,$D3:null,$2so:!1,$Yt:!1,$2Ei:!1,$qZ:0,$5mU:null,$ha:!1,$4x4:!1,$1Js:null,$3UU:null,$22m:null,$5XL:!1,$5Y2:!1,$3us:null,$2aS:null,$KO:null,$3ws:!1,$yN:null,$2E7:null,$32J:null,$2du:null,$28C:null,$1dh:!1,$5wI:null,$uG:null,$2F:null,$mU:2,$23X:!1,$Pi:null,$6R:null,$4ID:null,$Bq:null,$Mm_4:null,$3wK:!1,$ja:!1,$xo:null,$CY:null,$5Lb:null,$7Gp:function(){_js.Trace.logInfo(_at.$1j.$L,"Starting attachment upload.");var t=this,n=this;_g.$1H.$1Q.$4dl("CreateAttachment",this.$$d_$Ez7,this.$APW(),function(n){_js.Trace.logInfo(_at.$1j.$L,"Upload attachment enqueued. UploadOnlineOnlyAttachment will be called when we have connection to the server.")},function(t){_js.Trace.logWarning(_at.$1j.$L,"Enqueueing upload attachment failed: {0}",t.message);n.$2dq(1,_at.$6b.$3sd(t),!0);n.$4S0(null)})},add_$1GC:function(n){this.$32("OnUploadCompleteEvent",n)},remove_$1GC:function(n){this.$5d("OnUploadCompleteEvent",n)},add_$5GC:function(n){this.$32("OnUploadFailedEvent",n)},remove_$5GC:function(n){this.$5d("OnUploadFailedEvent",n)},add_$1s4:function(n){this.$32("OnDeleteCompleteEvent",n)},remove_$1s4:function(n){this.$5d("OnDeleteCompleteEvent",n)},add_$97s:function(n){this.$32("OnDownloadCompleteEvent",n)},remove_$97s:function(n){this.$5d("OnDownloadCompleteEvent",n)},add_$96f:function(n){this.$32("OnCancelCompleteEvent",n)},remove_$96f:function(n){this.$5d("OnCancelCompleteEvent",n)},set_$5mN:function(n){this.$32J=n;return n},get_$HO:function(){this.$1jH||(this.$1jH=this.$6Fa());return this.$1jH},get_$9P:function(){return this.$1w},set_$9P:function(n){var t=this.$1w;if(t!==n){$C(t)||t.remove_$EE(this.$$d_$7Wv);this.$1w=n;var i=$C(n);if(!i){n.add_$EE(this.$$d_$7Wv);_js.Trace.logInfo(_a.$0.$1m,"Attachment: {0}",n.get_$1x())}this.$8Ke(i?null:n.get_$6J());this.$4("Attachment");this.$4("ReferenceAttachment");this.$4("ReferenceAttachmentProviderTypeInfo");this.$7NC();this.$9wI()}return n},get_$R8:function(){return this.$mU},set_$R8:function(n){if(this.$mU!==n){this.$mU=n;this.$7NC()}return n},get_$2ty:function(){return _g.$7i.isInstanceOfType(this.$1w)?this.$1w:null},get_$DxW:function(){return this.get_$2ty()&&this.get_$2ty().get_$14j()?String.format(_nbs.NonBootStrings.l_ReferenceLinkShared_Text,_nbs.NonBootStrings.l_OneDriveProviderName_Text):""},get_$6J:function(){return this.$1w?this.$1w.get_$6J().Id:null},get_$8Wd:function(){return!!this.get_$2ty()&&(this.get_$HO()===1||this.get_$HO()===2)},get_$CET:function(){return this.get_$8Wd()&&this.$1E.get_$8b()},set_$2f:function(n){this.$3p=n;this.$4("IsSelected");return n},set_$5zr:function(n){if(this.$Y0!==n){this.$Y0=n;_js.Trace.logInfo(_at.$1j.$L,"Attachment download URL: {0}",this.$Y0);this.$4("DownloadUrl")}return n},set_$CFw:function(n){if(this.$3K2!==n){this.$3K2=n;this.$4("IsTriggeredPolicyTip")}return n},set_$1J6:function(n){this.$2ef=n;this.$3i("CanDelete","ShowDeleteButton");return n},set_$4SD:function(n){this.$4SC=n;this.$3i("AttachmentWellPendingRefresh","ShowDeleteButton");return n},get_$5Xu:function(){return this.$2ef||this.$4SC},set_$7O1:function(n){this.$7u||this.get_$5qJ()||this.set_$1J6(!n);this.$7O0=n;this.$4("UploadInProgress");return n},get_$3Sh:function(){return this.$6qs},set_$3Sh:function(n){this.$6qs=n;this.$4("OpenDocumentInBrowserLinkVisible");return n},set_$9Gq:function(n){this.$PG=n;this.$1jH=this.$6Fa();return n},get_$C8E:function(){return this.$9h},set_$Dos:function(n){this.$9h=n;this.$4("ParentWell");return n},get_$kd:function(){return this.$qE},set_$kd:function(n){if(this.$qE!==n){this.$qE=n;this.$9h&&this.$9h.$C03(this);this.$4("ShouldBeHidden")}return n},set_$6st:function(n){if(this.$2so!==n){this.$2so=n;this.$4("PendingNonHtml5Upload")}return n},get_$4HA:function(){return this.$5XL},set_$4HA:function(n){if(this.$5XL!==n){this.$5XL=n;this.$4("ShouldSizeBeHidden")}return n},get_$9jy:function(){return!this.$1w||!this.$1w.get_$6J()||!this.get_$2fQ()||!this.get_$2fQ().$1a.get_$A()},get_$3yr:function(){return!1},get_$9Es:function(){return!1},set_$9l8:function(n){if(this.$5Y2!==n){this.$5Y2=n;this.$4("ShowEditPermissionsInCompose")}return n},set_$7q6:function(n){if(this.$1Js!==n){this.$1Js=n;this.$4("FileExtension")}return n},set_$7HR:function(n){this.$3c5=n;this.$4("SubmitUploadFormCommand");return n},set_$Eky:function(n){this.$5ai=n;this.$4("SubmitUploadAndShareFormCommand");return n},get_$VW:function(){throw Error.notImplemented("This getter must be overridden");},get_$IR:function(){this.$2F||(this.$2F=new _bc.$3e);return this.$2F},get_$6qp:function(){return this.$19t},get_$1Cg:function(){return this.$IC},set_$64z:function(n){this.$1lh=n;_js.Trace.logWarning(_at.$1j.$L,"Attachment form upload error: {0}",this.$1lh);this.$4("FormUploadError");return n},set_$64y:function(n){this.$2Ib=n;_js.Trace.logWarning(_at.$1j.$L,"Attachment form upload error code: {0}",this.$2Ib);this.$4("FormUploadAttachmentError");return n},set_$5fi:function(n){this.$3eV=n;this.$4("UploadSuccessResponse");return n},get_$95b:function(){return!1},get_$3Sn:function(){return this.$Yt},get_$32Q:function(){return this.$qZ},get_$om:function(){return this.$22m},set_$om:function(n){this.$22m=n;return n},get_$vD:function(){var n=_y.$6k.$4n2(this.$1w.get_$6J(),this.$Dg,_g.$3U.get_$8O5());_js.Trace.logInfo(_at.$1j.$L,"Image preview URL: {0}",n);return n},get_$jf:function(){return this.$1E.get_$1LU()},get_$4uc:function(){return this.$1E.get_$22z()},get_$3I9:function(){return this.get_$HO()!==2&&this.get_$HO()!==1||this.$1w.get_$CA()?!1:this.$PG.$1Iv===3},get_$6Q1:function(){return this.get_$HO()!==2?!1:this.$PG.$1Iv===3},get_$C0m:function(){return this.get_$HO()!==2&&this.get_$HO()!==4},get_$C0o:function(){return!this.$1w.get_$X8()&&(this.get_$HO()===2||this.get_$HO()===1)},get_$6ME:function(){if(this.$3us)return this.$3us;var n;n=OwaApplication.$Oy&&this.get_$HO()===5?!1:this.get_$33m()?this.get_$HO()===5||!this.get_$4Gq()&&(!this.$Dg||this.$Dg&&this.get_$HO()!==3):this.get_$HO()===5||this.$I.get_$U()==="Mouse"&&this.get_$HO()!==3;_js.Trace.logInfo(_at.$1j.$L,"IconLinkViewModel preview = {0}",n);this.$3us=_at.$AS.$9(this,n,this.$I);return this.$3us},get_$End:function(){if(this.$2aS)return this.$2aS;if(this.$I.get_$U()!=="Mouse"){this.$2aS=_at.$AS.get_$8MZ();return this.$2aS}var t=!1;var n=!1;if(this.$1w.get_$X8()){n=_g.$7d.isInstanceOfType(this.$1w);t=n}else switch(this.get_$HO()){case 3:n=!1;t=this.get_$6Q3()?!1:!this.$Dg;break;case 6:n=!1;t=!1;break;case 1:case 2:t=!1;n=!1;break;case 5:if(OwaApplication.$Oy){t=!1;n=!1}else n=!0;break;case 4:n=!0;break;case 0:default:n=!0;break}if(n){_js.Trace.logInfo(_at.$1j.$L,"TextLinkViewModel is hidden");this.$2aS=_at.$AS.get_$8MZ()}else{_js.Trace.logInfo(_at.$1j.$L,"TextLinkViewModel preview = {0}",t);this.$2aS=_at.$AS.$9(this,t,this.$I)}return this.$2aS},get_$2fQ:function(){if(!this.$KO){var n=new Array(0);this.$KO=new _fm.$1u(n)}return this.$KO},set_$2fQ:function(n){this.$KO=n;this.$4("ContextMenu");return n},get_$16m:function(){return this.$I.get_$U()!=="Mouse"},get_$1ao:function(){return this.$99},get_$3u:function(){var n=this.get_$HO();switch(n){case 4:return _nbs.NonBootStrings.l_BlockedContent_Text;case 1:case 2:return _nbs.NonBootStrings.l_ClickForPreview_Text;case 6:case 3:return this.$1w.get_$1x();case 5:return OwaApplication.$Oy?this.$1w.get_$1x():_nbs.NonBootStrings.l_ClickForPreview_Text;default:break}return""},set_$4vE:function(n){if(this.$3ws!==n){this.$3ws=n;this.$3eM()}return n},get_$1dX:function(){return this.$ha},set_$1dX:function(n){if(this.$ha!==n){this.$ha=n;this.$4("IsDeleted")}return n},set_$lw:function(n){this.$ja!==n&&(this.$ja=n);return n},set_$8Sz:function(n){if(this.$3wK!==n){this.$3wK=n;this.$4("IsCancelling")}return n},get_$2gn:function(){_a.$4.$FY(this.get_$HO()===5,"Invalid Operation: EmbeddedItemClass should only be invoked when the Attachment is an ItemAttachment");return this.$1w.get_$HO()},get_$6Q3:function(){return!!this.$1D&&(this.$1D.$2r("DocCollab")||this.$1D.$2r("ModernAttachments"))},get_$CAk:function(){return!!this.$1D&&!!this.$CY&&this.$1D.$2r("AttachmentsFilePicker")&&this.$CY.AttachmentDataProviderAvailable},get_$33m:function(){return this.get_$6Q3()&&this.$I.get_$U()!=="TouchNarrow"&&(this.$PG.$2zp||this.get_$HO()===1||this.get_$HO()===2)&&!this.get_$3Jo()},get_$4Gq:function(){return this.$1E.get_$fP()||this.$1E.get_$JM()||this.$I.get_$U()==="TouchNarrow"||!this.$7u&&this.$I.get_$U()==="TouchWide"},set_$A8T:function(n){if(this.$2E7!==n){this.$2E7=n;this.$4("AttachmentPreviewViewModel")}return n},get_$1Lf:function(){return this.$1dh},set_$1Lf:function(n){this.$1dh=n;n&&this.set_$3Sh(!1);return n},set_$4xC:function(n){this.$23X=n;this.$4("IsOpenedInLightBox");this.$4("IsComposedInLightBox");this.get_$6PX()&&this.set_$1J6(!1);return n},get_$6PX:function(){_js.Trace.logInfo(_a.$0.$16,"AttachementName={4}, IsComposedInLightBox={5}, ParentWellIsNULL={0}, isOpenedInLightBox = {1}, this.parentWell.IsReadOnly={2}, WacEdit={3}",!this.$9h,this.$23X,this.$9h.get_$HC(),this.$PG.$300,this.$1w?this.$1w.get_$1x():"null",this.$23X&&!this.$9h.get_$HC()&&this.$PG.$300);return this.$9h?this.$23X&&!this.$9h.get_$HC()&&this.$PG.$300:!1},get_$1C6:function(){!this.$xo&&this.get_$5qJ()&&(this.$xo=(+new Date).toString());return this.$xo},get_$5qJ:function(){var n=!!this.$1D&&this.$1D.$2r("ModernAttachments");return!n||this.$1E.get_$8b()||this.$1E.get_$4S3()?!1:!this.$9h.get_$132()||!!this.$Mm_4&&this.$Mm_4.$2Nq(this.$9h.get_$132(),"AttachmentUploadCancellation")},get_$5q2:function(){var n=!!this.$1w.get_$6J();var i=n?this.$1w.get_$6J().Id:null;var t=i?_bc.$9F.$8T2(i):!1;var r=this.$PG.$1Iv===1;_js.Trace.logInfo(_at.$1j.$L,"UpdateDownloadUrl: idExists={0}, isClientId={1}, policyInfo: {2}",n,t,this.$PG.toString());return n&&!r&&!t&&!this.$1w.get_$23t()},get_$C93:function(){return!this.$9h},get_$ADl:function(){_js.Trace.logInfo(_at.$1j.$L,"Attachment class: {0}",this.$1jH);var n;switch(this.get_$HO()){case 0:n=!0;break;case 5:_js.Trace.logInfo(_at.$1j.$L,"Embedded item class: {0}",this.get_$2gn());switch(this.get_$2gn()){case 6:case 3:case 1:case 2:case 5:case 7:n=!0;break;default:n=!1;break}break;default:n=!1;break}_js.Trace.logInfo(_at.$1j.$L,"Can open: {0}",n);return n},get_$3Jo:function(){return this.$1w.get_$X8()||this.$1w.get_$23t()},$3eM:function(){this.$9h?this.set_$kd(this.$3ws||this.$1w.get_$CA()&&this.$9h.get_$C2F()&&!_g.$7i.isInstanceOfType(this.$1w)):this.set_$kd(this.$3ws||this.$1w.get_$CA());this.set_$kd(this.$qE||this.$1w.get_$2mu())},$DXk:function(){_js.Trace.logInfo(_at.$1j.$L,"File selected.");this.set_$4vE(!1);this.$9h&&this.$9h.$DXj(this)},$2bh:function(){_js.Trace.logInfo(_at.$1j.$L,"submitting upload to server");this.$Yt=!1;if(_g.$54.isInstanceOfType(this.$1w)){var n=this.$1w;this.$9wt(n)}else(_g.$7S.isInstanceOfType(this.$1w)||_g.$7d.isInstanceOfType(this.$1w)||_g.$7i.isInstanceOfType(this.$1w))&&this.$7Gp()},$7HK:function(){_js.Trace.logInfo(_at.$1j.$L,"submitting delete to server");this.$Yt=!1;var n=new _at.$1Dg(2,this.$1w,this.$9h.get_$F7());n.add_$2b(this.$$d_$AUk);n.add_$4Q(this.$$d_$5xl);OwaApplication.$2B.$1V(n)},$6Gn:function(){var i=this.$1w;var r=i.$LJ;var n=this.$636.$5uP();var t=this;n.set_$9AI(function(){if(n.get_$Kt())_js.Trace.logWarning(_at.$1j.$L,"HTML5 file reader attach failed with error code {0}",n.get_$Kt());else{var r=n.get_$4d().indexOf(",");var i=n.get_$4d().substring(r+1,n.get_$4d().length);t.$yN=n.get_$4d().substring(0,r).indexOf("base64")!==-1?i:_a.$5u.$Jh(i);t.$AQ("OnUploadCompleteEvent",t)}});try{n.$9KH(r)}catch(u){this.$1E.get_$1LU()&&u.name==="NS_ERROR_FILE_ACCESS_DENIED"?_js.Trace.logInfo(_at.$1j.$L,"Firefox: failed to read an attachment. Exception: {0}",u.message):_js.Trace.logException(_at.$1j.$L,u,"Unexpected exception was thrown by FileReader.ReadAsDataURL.")}},$6wR:function(){this.$yN=null;this.$AQ("OnDeleteCompleteEvent",this);if(this.$uG){_a.$6.$1G(this.$uG,null,"",null,this.$36J(1));this.$uG=null}},$7Kq:function(){this.$28C=_a.$6.$1g(_a.$0.$1m,"AttachmentUploadQueue",!0)},$5dC:function(n){if(this.$28C){_a.$6.$1G(this.$28C,null,n,null,this.$Lv());this.$28C=null}},$7Kr:function(){if(this.$28C){_a.$6.$1G(this.$28C,null,null,null,this.$Lv());this.$28C=null}if(this.$32J){this.$2du=_a.$6.$1g(_a.$0.$1m,this.$32J,!0);_at.$GS.$A2M(this.$2du)}},$5dD:function(){if(this.$2du){var n="";this.$Yt&&(n=this.$5mU);_a.$6.$1G(this.$2du,null,n,null,this.$Lv());_at.$GS.$A2L(this.$2du,n,this.$1Js,this.$1w.get_$8D());this.$2du=null}},$1l4:function(){_js.Trace.logInfo(_at.$1j.$L,"Getting attachment content from server");this.$Yt=!1;var n=new _at.$1Fd(_at.$1j.$L,this.$1w);var i=this;n.add_$4Q(function(){i.$AQ("OnDownloadCompleteEvent",i);i.set_$3Sh(!1)});var t=this;n.add_$2b(function(){_js.Trace.logWarning(_at.$1j.$L,"Download failed with error: {0}",n.$2H.message);t.$Yt=!0;t.$1dh||t.$4X7(n)});OwaApplication.$2B.$1V(n)},$8RM:function(n){if(_g.$7S.isInstanceOfType(this.$1w)||_g.$7d.isInstanceOfType(this.$1w)){_js.Trace.logInfo(_at.$1j.$L,"Uploading item or id attachment.");this.$Ez5()}else if(_g.$54.isInstanceOfType(this.$1w)){var t=this.$1w;if(this.$yN){_js.Trace.logInfo(_at.$1j.$L,"Uploading file attachment with pasted image from clipboard.");this.$749(this.$yN)}else if(t.get_$DY()){_js.Trace.logInfo(_at.$1j.$L,"Uploading file attachment with content.");this.$749(null)}else if(t.get_$CA()&&_a.$RV.isInstanceOfType(this.$1w.$LJ)&&_at.$34.isInstanceOfType(this)){_js.Trace.logInfo(_at.$1j.$L,"Uploading inline PAL image with content.");this.$9ww()}else if(this.$1E.get_$5mW()){_js.Trace.logInfo(_at.$1j.$L,"Uploading HTML5 file attachment.");this.$9wu(t.$LJ)}else{_js.Trace.logInfo(_at.$1j.$L,"Uploading Non-HTML5 file attachment.");this.$9wv()}}else if(_g.$7i.isInstanceOfType(this.$1w)){this.$4x4=!0;if(this.$1E.get_$5mW()){_js.Trace.logInfo(_at.$1j.$L,"Uploading HTML5 reference attachment.");var i=this.$1w;this.$9wu(i.$LJ)}else{_js.Trace.logInfo(_at.$1j.$L,"Uploading Non-HTML5 reference attachment.");this.$9wv()}}else{_js.Trace.logError(_at.$1j.$L,"Unsupported upload type.");n(null)}},$6Fa:function(){var n=0;if(_g.$54.isInstanceOfType(this.$1w))if(this.$PG.get_$4z7())n=3;else{var i,t;(t=_y.$6k.$7Di(this.$1w,i={val:n}),n=i.val,t)||(n=this.$PG.$1Iv===1?4:6)}else n=_g.$7d.isInstanceOfType(this.$1w)?5:_g.$7S.isInstanceOfType(this.$1w)?0:4;return n},$4Kt:function(){this.get_$5q2()?this.set_$5zr(_y.$6k.$4n2(this.$1w.get_$6J(),this.$Dg)):this.set_$5zr(null)},$4X7:function(n){this.$2dq(1,_at.$6b.$2kE(n),!0)},$2dq:function(n,t,i){this.$Yt=!0;if(this.$ja)_js.Trace.logInfo(_at.$1j.$L,"Attachment create failed callback after cancellation with cancellationId:{0} error: {1}, {2}",this.get_$1C6(),n,t);else{_js.Trace.logWarning(_at.$1j.$L,"Attachment create failed with cancellationId: {0} error: {1}, {2}",this.get_$1C6(),n,t);this.$qZ=n;this.$5mU=t;this.$9h&&this.$9h.$3yk(this.$99)&&this.$9h.$1X4(this,!1)}this.$AQ("OnUploadFailedEvent",this)},$35J:function(n){this.$4S0(n)},$9vU:function(){this.set_$6st(!this.$7u&&this.$1E.get_$4S3()&&$C(this.$1w.get_$6J())&&!_g.$7S.isInstanceOfType(this.$1w))},$7Wv:function(n,t){if(t==="ContentType"||t==="Name"||t==="AttachmentId"){t==="Name"&&this.set_$7q6(_a.$69.$li(this.$1w.get_$1x()));if(t==="ContentType"||t==="Name"){this.set_$9Gq(_at.$64.get_$Q().$4og(this.$1Js,this.$1w.get_$KN(),this.$I.get_$U()==="Mouse"||this.$1E.get_$2P6(),this.get_$3Jo()));this.$3eM()}if(t==="AttachmentId"){this.$8Ke(this.$1w.get_$6J());this.$9vU();this.$9wI()}this.$4Kt()}},$749:function(n){var t=this.$1w;n&&t.set_$DY(n);this.$E9R(t)},$9wv:function(){this.$3c5.$11()},$ALH:function(){_js.$9.$o(this.$1lh)||this.$2dq(this.$2Ib,this.$1lh,!1);this.$4S0(null)},$44:function(n){this.$2F?this.get_$IR().$44(0,n,null):_a.$3m.$44(n,1)},$9wt:function(n){this.$7Gp()},$9ww:function(){_js.Trace.logInfo(_at.$1j.$L,"Submitting action for PAL attachment upload.");var n=new _at.$1DA(2,this.$1w,this.$9h.get_$F7(),this.get_$1C6());n.add_$2b(this.$$d_$4X7);n.add_$4Q(this.$$d_$35J);OwaApplication.$2B.$1V(n)},$7kT:function(n){_js.Trace.logInfo(_at.$1j.$L,"Not a PAL file attachment.")},$6qo:function(){_js.Trace.logWarning(_at.$1j.$L,"Opening attachment with download URL {0}",this.$Y0);if(this.$1E.get_$8b())if(this.$l_4.$8G(this.$l_4.get_$IF())&&this.$l_4.get_$IF().get_$2H9().get_$2PY()){_js.Trace.logInfo(_at.$1j.$L,"Launch URL from nativeBridge");this.$l_4.get_$IF().$2PX(this.$Y0)}else{_js.Trace.logInfo(_at.$1j.$L,"Creating an anchor element to download file as OpenInTarget doesn't work in PAL");var t=document.createElement("a");t.href=this.$Y0;var n=document.createEvent("MouseEvent");n.initMouseEvent("click",!1,!1,window.self,0,n.screenX,n.screenY,n.clientX,n.clientY,n.ctrlKey,n.altKey,n.shiftKey,n.metaKey,0,null);t.dispatchEvent(n)}else this.$7u?this.$Qa.$3Si(this.$Y0,"_self"):this.$Qa.$3Si(this.$Y0,"_blank")},$965:function(n,t){this.$D3=t;_js.Trace.logInfo(_at.$1j.$L,"Attachment ID: {0}",this.$D3?this.$D3.Id:"null")},$3e5:function(){var n=new _fm.$1u(new Array(0));this.get_$CAk()&&this.get_$2ty()&&!this.$7u&&n.$1a.$F(new _fm.$d(_u.Strings.l_ContextMenu_ManagePermissions_Text,null,this.$6Y1));if(this.get_$HO()===4||this.$PG.$1Iv===2||this.get_$4Gq())this.get_$4Gq()&&this.get_$33m()&&!this.get_$CET()&&n.$1a.$F(new _fm.$d(_nbs.NonBootStrings.l_Preview_Text,null,this.$27z));else{var i=this.get_$8Wd()?_nbs.NonBootStrings.l_OpenInBrowser_Text:_nbs.NonBootStrings.l_Download_Text;var t=this.$1E.get_$8b()?_nbs.NonBootStrings.l_OpenInDevice_Text:i;n.$1a.$F(new _fm.$d(t,null,this.$1zK))}this.set_$2fQ(n)},$DnZ:function(){this.$9h.$Dng(this)},$E9R:function(n){_js.Trace.logInfo(_at.$1j.$L,"Submitting server action for file attachment with content.");var t=new _at.$Cu(2,n,this.$9h.get_$F7(),this.get_$1C6());t.add_$2b(this.$$d_$4X7);t.add_$4Q(this.$$d_$35J);OwaApplication.$2B.$1V(t)},set_$6xQ:function(n){this.$5Lb=n;return n},$2g4:function(){if(!this.$8LB(0)){_js.Trace.logInfo(_at.$1j.$L,"Deleting attachment.");this.$uG=_a.$6.$1g(_a.$0.$1m,"AttachmentDeleteAttachment",!0);this.set_$1dX(!0);var n="";var i=!!this.$1w.get_$6J()&&!!this.$1w.get_$6J().Id&&!this.$1w.get_$6J().Id.startsWith("smime-");if(i){_js.Trace.logInfo(_at.$1j.$L,"Deleting attachment from server.");this.$9h.$1X4(this,!1);this.$9h.$5Ks(this)}else if(this.$7O0)if(this.get_$5qJ())this.$4UA();else{_js.Trace.logError(_at.$1j.$L,"Somehow a user was able to try to delete an attachment in the process of being uploaded.");_a.$6.$1G(this.$uG,null,n="DeleteInProcessAttachment",null,this.$36J(0));this.$uG=null}else{if(_g.$54.isInstanceOfType(this.$1w)){var t=this.$1w;this.$7kT(t)}else _js.Trace.logInfo(_at.$1j.$L,"Not a file attachment.");this.$9h.$1X4(this,!0);_a.$6.$1G(this.$uG,null,"",null,this.$36J(0));this.$uG=null;n="DeletedWhileInQueue"}this.$28C&&this.$5dC(n)}},$4UA:function(){if(!this.$3wK){_js.Trace.logInfo(_at.$1j.$L,"Cancel attachment with cancellationId {0}",this.get_$1C6());this.$2Ei=!1;this.set_$8Sz(!0);var n=new _at.$1CI(this.get_$1C6());n.add_$2s(this.$$d_$ACy);n.add_$2b(this.$$d_$ACx);OwaApplication.$2B.$1V(n)}},$Ez7:function(n,t,i){this.set_$7O1(!0);if(this.$ha){_js.Trace.logInfo(_at.$1j.$L,"Attachment skipped because it's been deleted while it was pending.",this.$1w.get_$1x());t(null);return}var u=n;var r=u.Body.ParentItemId;this.$9h.get_$F7().Id=r.Id;this.$9h.get_$F7().ChangeKey=r.ChangeKey;this.$3UU=t;this.$8RM(t)},$9wu:function(n){var t=this.$5wI=this.$636.$5uP();t.$5L6(n,this.$$d_$749,this.$$d_$634,_at.$1j.$L)},$634:function(){this.$2dq(2,_at.$6b.$Bmz(this.$5wI),!1);this.$4S0(null)},$Ez5:function(){_js.Trace.logInfo(_at.$1j.$L,"Submitting action for item or id attachment.");var n=new _at.$Cu(2,this.$1w,this.$9h.get_$F7(),this.get_$1C6());n.add_$2b(this.$$d_$4X7);n.add_$4Q(this.$$d_$35J);OwaApplication.$2B.$1V(n)},$APW:function(){var t=this.$9h.get_$F7();var n=new _g.$1T(t.Id);n.ChangeKey=t.ChangeKey;var i=new _g.$UE(n);return new _g.$UD(null,i)},$4S0:function(n){var t=this.$Yt?_y.$Lb.toString(this.$qZ):"";_js.Trace.logInfo(_at.$1j.$L,"Attachment create completed. Status: {0} CancellationId: {1}",t,this.get_$1C6());if(!this.$ja){if(this.$3UU){n&&this.set_$5fi(n.$BuK());this.$3UU(this.$3eV)}this.set_$7O1(!1);this.set_$3Sh(!this.$Yt&&this.$PG.get_$4z7());this.$3e5();if(_g.$7d.isInstanceOfType(this.$1w)){this.$9h.$1X4(this,!1);this.set_$9P(n.$1w);this.$4Kt();this.$9h.$1iv(this)}if(this.$Ebq()){_js.Trace.logInfo(_at.$1j.$L,"Incrementing parent well size.");(!n||this.$9h.$3yk(this.$99))&&this.$9h.$hY(this.$1w.get_$8D());this.$9wJ()}}this.$AQ("OnUploadCompleteEvent",this)},$Ebq:function(){if(this.$Yt||this.$ja)return!1;if(this.$1E.get_$4S3()||_g.$7S.isInstanceOfType(this.$1w)||_g.$7i.isInstanceOfType(this.$1w))return!0;if(_g.$54.isInstanceOfType(this.$1w)){var n=this.$1w.$LJ;if(_y.$mk.isInstanceOfType(n))return!0;if(_y.$HR.isInstanceOfType(n))return n.get_$8XJ()}return!1},$ACy:function(n){_js.Trace.logInfo(_at.$1j.$L,"Cancel attachment succeeded with cancellationId {0}",this.get_$1C6());this.set_$7O1(!1);this.$9h&&this.$9h.$3yk(this.$99)&&this.$9h.$1X4(this,!1);this.$7Zo(n)},$ACx:function(n){_js.Trace.logWarning(_at.$1j.$L,"cancel failed with error: {0} and cancellationId: {1}",n&&n.$2H?n.$2H.message:"N/A",this.get_$1C6());this.$2Ei=!0;this.$7Zo(n)},$7Zo:function(n){this.$3UU&&this.$3UU(null);this.set_$8Sz(!1);this.set_$lw(!this.$2Ei);this.$AQ("OnCancelCompleteEvent",this);var t=this.$2Ei?_at.$6b.$2kE(n):"";if(this.$uG){_a.$6.$1G(this.$uG,null,t,n?n.$FJ():null,this.$36J(2));this.$uG=null}},$AUk:function(n){_js.Trace.logWarning(_at.$1j.$L,"delete failed with error: {0}",n.$2H.message);this.$Yt=!0;this.set_$1dX(!1);this.$9h.$3yk(this.$99)&&!this.$1dh&&this.$9h.$1iv(this);if(this.$uG){_a.$6.$1G(this.$uG,null,_at.$6b.$2kE(n),n?n.$FJ():null,this.$36J(1));this.$uG=null}},$5xl:function(n){this.$AQ("OnDeleteCompleteEvent",this);if(this.$uG){_a.$6.$1G(this.$uG,null,"",n?n.$FJ():null,this.$36J(1));this.$uG=null}},$EZ9:function(){_y.$9Q.$4HD=this.$I.get_$U()==="Mouse"&&this.$I.get_$Cp()&&!this.get_$3yr();this.$2Y&&this.$9h&&this.$9h.get_$F7()&&this.$2Y.$5GG(this.$9h.get_$F7())},$aV:function(){(this.$7u||this.$1w.get_$6J())&&(this.$8LB(1)||(this.get_$33m()&&!this.get_$4Gq()?this.$WU():this.$4bk()))},$8LB:function(n){if(this.$4SC&&this.$5Lb){_js.Trace.logInfo(_at.$1j.$L,"AttachmentWellPendingRefresh was true, so triggering refresh of the attachment well with operation: "+n);this.set_$4SD(!1);this.$5Lb(this.$1w,n);return!0}return!1},$4bk:function(){this.get_$6Q3()&&(_y.$9Q.$4HD=this.$I.get_$U()==="Mouse"&&this.$I.get_$Cp()&&!this.get_$3yr());if(this.$1w.get_$6J())if(OwaApplication.$Oy){_js.Trace.logInfo(_at.$1j.$L,"GenericMailMode, always download the attachment.");this.$5OG()}else if(_g.$7d.isInstanceOfType(this.$1w))this.$5GL();else if(_g.$54.isInstanceOfType(this.$1w))this.$5OG();else if(_g.$7S.isInstanceOfType(this.$1w)){var n=this.$1w;n.get_$y()?this.$5GL():n.get_$a7()?this.$5GL():this.$5OG()}else this.$5OG()},$5GL:function(){if(!this.get_$ADl()){_js.Trace.logInfo(_at.$1j.$L,"Unsupported item.");this.$44(_nbs.NonBootStrings.l_ItemAttachmentNotSupported_Text);return}if(this.$1w.get_$23t()){var n=this;this.$uP(function(t){t.$A3U();n.$9Dp()})}else this.$9Dp()},$9Dp:function(){var n={};n.AttachmentItemID=this.$1w.get_$6J().Id;_js.Trace.logInfo(_at.$1j.$L,"Opening item attachment in pop-out window.");this.$I.$A0(IItemAttachmentPopOutFactory,null,n,_bc.$2I.get_$s6())},$5OG:function(){this.$EtQ();this.$1w?this.$1w.get_$6J()?_js.Trace.logInfo(_at.$1j.$L,"SafeOpenAttachment: Name={0}, ID={1}",this.$1w.get_$1x(),this.$1w.get_$6J().Id):_js.Trace.logWarning(_at.$1j.$L,"SafeOpenAttachment: AttachmentId is null"):_js.Trace.logWarning(_at.$1j.$L,"SafeOpenAttachment: Attachment is null");_js.Trace.logInfo(_at.$1j.$L,"SafeOpenAttachment: Policy={0}",this.$PG.toString());if(this.$PG.$3A7){_js.Trace.logInfo(_at.$1j.$L,"Attachment policy forces browser viewing.");this.$I.get_$U()==="Mouse"?this.$44(_nbs.NonBootStrings.l_ForceBrowserViewingFirstAlert_Text):this.$44(_nbs.NonBootStrings.l_ForceBrowserViewingFirstAlertNonMouse_Text);return}if(!this.$PG.$1RC){this.$44(_nbs.NonBootStrings.l_DirectFileAccessDisabled_Text);return}if(this.$PG.$1Iv===1){this.$44(_nbs.NonBootStrings.l_BlockedAlert_Text);return}if(this.get_$3Jo()){var n=this;this.$uP(function(n){n.$E6P()});return}if(this.$PG.$1Iv===2){this.$EeL();return}this.$1w&&this.get_$5q2()&&this.$6qo()},$EeL:function(){if(this.$I.get_$U()==="Mouse"){_js.Trace.logInfo(_at.$1j.$L,"Attachment policy forces save.");this.$1E.get_$Df()?this.$44(_nbs.NonBootStrings.l_IE_ForceSaveAlert_Text):this.$44(_nbs.NonBootStrings.l_Default_ForceSaveAlert_Text)}else{_js.Trace.logInfo(_at.$1j.$L,"Attachment policy forces save, but device doesn't support download.");this.$44(_nbs.NonBootStrings.l_UnsupportedAttachment_Text)}},$WU:function(){if(this.$2E7){this.$2E7.$3w8()&&this.$9h.$4GB(this.$1w.get_$6J());this.$2E7.$WU();return}if(this.$1Bq){var n=this;this.$1Bq.$9(function(t){if(!n.$9h){_js.Trace.logError(_a.$0.$1m,"Preview: Parent well is null.");return}n.set_$A8T(t.$9(n,n.$9h.get_$7X0(),n.$Pi,n.$6R));n.$2E7.$3w8()&&n.$9h.$4GB(n.$1w.get_$6J());n.$2E7.$WU()})}},$8Ke:function(n){var t=this.$D3;t!==n&&this.$965(t,n)},$9wJ:function(){this.set_$4HA(this.$2so||_g.$7S.isInstanceOfType(this.$1w)&&!this.$1w.get_$8D()||_g.$54.isInstanceOfType(this.$1w)&&_y.$mk.isInstanceOfType(this.$1w.$LJ)&&!this.$1w.get_$8D()||_g.$54.isInstanceOfType(this.$1w)&&_y.$HR.isInstanceOfType(this.$1w.$LJ)&&!this.$1w.get_$8D())},$7NC:function(){this.get_$2ty()&&(this.$mU===2?this.set_$9l8(!0):this.set_$9l8(!1))},$EtQ:function(){if(!this.get_$3Jo()&&this.get_$95b()){var n=_g.$1H.$1Q.$1d4(this.$1w.get_$6J());this.$1w.get_$6J().Id!==n.Id&&this.$1w.set_$6J(n)}},$Lv:function(){var n=new _a.$3z;n.$5H("S",this.$1w.get_$8D());n.$5H("W",this.$9h.get_$132()?1:0);n.$5H("C",this.$ja?1:0);n.$CX("E",this.$1Js);return n.toString()},$36J:function(n){var t=new _a.$3z;t.$5H("S",this.$1w.get_$8D());var i="A";_at.$Uj.isInstanceOfType(this)?i="C":this.get_$HO()===5?i="T":this.$1w.get_$CA()&&(i="I");t.$CX("T",i);t.$5H("O",n);t.$5H("W",this.$9h.get_$132()?1:0);this.$32J&&t.$CX("Q",this.$32J);t.$CX("E",this.$1Js);return t.toString()},$9wI:function(){this.$4("ShouldAffordanceMenuBeHidden")},$uP:function(n){if(this.get_$3Jo()){_js.Trace.logInfo(_a.$0.$53,"[AttachmentViewModel] Creating Smime command factory.");var t=this;this.$Bq.$9(function(i){if(!t.$4ID){_js.Trace.logInfo(_a.$0.$53,"[AttachmentViewModel] Creating smimeAttachmentViewModelCommand instance.");t.$4ID=i.$ALP();t.$4ID.$3e(t.$1w)}_js.Trace.logInfo(_a.$0.$53,"[AttachmentViewModel] Executing smime operation.");n(t.$4ID)})}}};_at.$1BA=function(n,t,i,r,u,f,e,o,s,h,c,l,a){this.$9yK=_at.$1j;_a.$4.$X(t,"owaShell");_a.$4.$X(i,"palDownloadManager");_a.$4.$X(r,"userAgent");_a.$4.$X(u,"nativeBridge");_a.$4.$X(s,"itemStoreGetterFactory");this.$2Y=n;this.$I=t;this.$sd=i;this.$1E=r;this.$l=u;this.$32S=f;this.$9I=e;this.$1Bq=o;this.$1e3=s;this.$5fk=h;this.$Bq=c;this.$Mm=l;this.$CY=a};_at.$1BA.prototype={$I:null,$1E:null,$sd:null,$l:null,$9I:null,$1Bq:null,$1e3:null,$2Y:null,$Mm:null,$32S:null,$3hi:null,$9yK:null,$5fk:null,$Bq:null,$CY:null,$9:function(n,t,i,r,u,f){if(this.$8SZ()&&(_g.$7i.isInstanceOfType(n)||_g.$54.isInstanceOfType(n)&&_y.$HR.isInstanceOfType(n.$LJ))){if(!this.$3hi&&this.$32S){var e=this;this.$32S.$9(function(n){e.$3hi=n})}_a.$4.$z(this.$3hi,"attachmentProviderItemViewModelFactory");return this.$3hi.$9(n,this.$I,t,i,r,this.$1E)}else if(_g.$54.isInstanceOfType(n)&&_y.$mk.isInstanceOfType(n.$LJ)){_a.$4.$z(this.$5fk,"uriFileAttachmentViewModelFactory");return this.$5fk.$9(n,this.$I,t,i,r,this.$1E)}else return new _at.$34(n,this.$I,t,i,r,this.$sd,this.$2Y,this.$l,this.$1E,this.$9I,this.$1Bq,this.$1e3,u,f,this.$Bq,this.$Mm,this.$CY)},$4X6:function(n,t,i,r,u,f,e){if(this.$8SZ()&&this.$32S&&(_g.$7i.isInstanceOfType(n)||_g.$54.isInstanceOfType(n)&&_y.$HR.isInstanceOfType(n.$LJ))){var o=this;var h=function(f){var e=f.$9(n,o.$I,t,i,r,o.$1E);u(e)};this.$32S.$9(h)}else{var s=new _at.$34(n,this.$I,t,i,r,this.$sd,this.$2Y,this.$l,this.$1E,this.$9I,this.$1Bq,this.$1e3,f,e,this.$Bq,this.$Mm,this.$CY);u(s)}},$ALA:function(n,t,i,r,u,f,e){if(!n){u(null);return}if(!n.length){u(new Array(0));return}this.$7iF(n,0,new Array(0),t,i,r,u,f,e)},$7iF:function(n,t,i,r,u,f,e,o,s){var h=this;this.$4X6(n[t],r,u,f,function(c){Array.add(i,c);t<n.length-1?h.$7iF(n,t+1,i,r,u,f,e,o,s):e(i)},o,s)},$8SZ:function(){return!this.$9I||!this.$CY?!1:this.$9I.$2r("AttachmentsFilePicker")&&this.$CY.AttachmentDataProviderAvailable}};_at.$TP=function(n){this.$3hl=n};_at.$TP.prototype={$3hl:null};_at.$6b=function(){};_at.$6b.$2kE=function(n){var t;if(n){if(_h.$12o.isInstanceOfType(n)&&(t=n.get_$2Ck())){if(t.responseCode)return t.responseCode;if(t.response){if(t.response.fault){var r=t.response.fault;var i=_at.$6b.$8Es(r);if(i)return i}if(t.response.statusCode)return _at.$6b.$64t(t.response.statusCode)}}if(n.$2H)return _at.$6b.$3sd(n.$2H)}return"UnknownError_Action"};_at.$6b.$3sd=function(n){if(n){var t;if(t=n.responseCode)return t.toString();if(t=n.StackTrace)return _at.$6b.$8Et(t.toString());if(t=n.ErrorCode)return _at.$6b.$64t(t);if(t=n.name){var i=t.toString();if(i!=="Error")return i;else if(n.message)return n.message}}return"UnknownError_Exception"};_at.$6b.$8Es=function(n){if(n){if(n.ResponseCode)return n.ResponseCode;if(n.StackTrace)return _at.$6b.$8Et(n.StackTrace);if(n.ErrorCode)return _at.$6b.$64t(n.ErrorCode)}return null};_at.$6b.$8Et=function(n){var i;var t;if((i=n.indexOf(":"))!==-1||(i=n.indexOf("\n"))!==-1){t=n.substr(0,i);if((i=n.indexOf("\n"))!==-1){var u=new RegExp("[_a-zA-Z0-9.]+\\(");var r=u.exec(n.substr(i));r&&(t=t+"@"+r[0].substr(0,r[0].length-1))}}else t=n;return t};_at.$6b.$64t=function(n){return"HTTP_"+n};_at.$6b.$Bmz=function(n){var i=n.get_$Kt();if(i){var t;t=Number.isInstanceOfType(i)?i:i.code;return t>=1&&t<_at.$6b.$635.length?_at.$6b.$635[t]:_at.$6b.$3sd(i)}return n.get_$38z()?_at.$6b.$3sd(n.get_$38z()):"UnknownError_FileReader"};_at.$Uj=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w){this.$$d_$ALG=Function.createDelegate(this,this.$ALG);this.$$d_$ALN=Function.createDelegate(this,this.$ALN);this.$$d_$A7z=Function.createDelegate(this,this.$A7z);_at.$Uj.initializeBase(this,[n,t,i,r,u,s,f,h,c,l,a,v,y,p,w]);this.$PD=e;this.$n=o};_at.$Uj.$AJp=function(n){return n&&n.ResultCode===10?5:1};_at.$Uj.prototype={$n:null,$PD:null,$5Lk:function(){var n=_g.$1H.$Yw;n?n.$DyG(this.get_$VW(),this.$$d_$A7z,this.get_$Br()):this.$PD.$28W(this.get_$VW(),_a.$0.$4W,this.get_$Br(),this.$$d_$A7z,0)},$9t8:function(){var n=_g.$1H.$Yw;n?n.$EsR(this.get_$VW(),this.$$d_$A7z):this.$PD.$2zS(this.get_$VW(),this.$$d_$A7z)},$35J:function(n){this.$9t8();_at.$1j.prototype.$35J.call(this,n)},$ALN:function(n){},$ALG:function(n){this.$4X7(n);this.$35J(null)},$A7z:function(n){var i=null;var t=n;i=n?this.$9IS(t.Response):"The notification received is null";if(i){t&&(i+=". AttachmentProviderResultCode = "+t.ResultCode);this.$2dq(_at.$Uj.$AJp(t),i,!0)}else this.$9Ip(t);this.$35J(null)},$9Ip:function(n){},$9IS:function(n){var r=null;if(n&&n.ResponseMessages&&n.ResponseMessages.Items&&n.ResponseMessages.Items.length)if(n.ResponseMessages.Items[0].ResponseCode!=="NoError")r="ResponseMessages response code = "+n.ResponseMessages.Items[0].ResponseCode;else{var i=n.ResponseMessages.Items[0];this.$1w.set_$8D(i.Attachments[0].Size);_at.$Cu.$9IL(i,this.$1w,this.$9h.get_$F7());if(_g.$7i.isInstanceOfType(this.$1w)&&i.Attachments.length>=1&&i.ResponseCode==="NoError"){var t=i.Attachments[0];if(t.AttachLongPathName){this.$1w.set_$2dp(t.AttachLongPathName);this.$1w.set_$14j(t.ProviderType);this.$1w.set_$1so(t.ProviderEndpointUrl);this.$1w.set_$SF(t.ContentId)}this.$1w.set_$1x(t.Name)}}else r="The response message received is null";return r}};_at.$yA=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){_at.$yA.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c,null,null,l,a,v,y])};_at.$yA.$4gE=function(){return"UriFileAttachmentNotification"+(_a.$8.get_$38().$8a()+_ff.$8d.$3Uh(0,1e3)).toString()};_at.$yA.prototype={$ML:null,get_$VW:function(){this.$ML||(this.$ML=_at.$yA.$4gE());return this.$ML},set_$VW:function(n){this.$ML=n;return n},get_$Br:function(){return"UriFileAttachmentViewModel"},get_$5qJ:function(){return!1},$8RM:function(n){if(_g.$54.isInstanceOfType(this.$1w)&&_y.$mk.isInstanceOfType(this.$1w.$LJ)){_js.Trace.logInfo(_a.$0.$4W,"Uploading attachment from URL");var i=this.$1w.$LJ;this.$5Lk();var t=new _at.$1D8(this.$9h.get_$F7(),i.get_$EzF(),i.get_$1x(),this.get_$VW());t.add_$2s(this.$$d_$ALN);t.add_$2b(this.$$d_$ALG);this.$n.$1V(t)}else{_js.Trace.logError(_a.$0.$4W,"Unsupported upload type detected in addFileAttachment");n(null)}},$9vU:function(){this.set_$6st(!1)}};_at.$19o=function(n,t,i,r,u,f,e,o,s,h){this.$PD=n;this.$n=t;this.$2Y=i;this.$1D=r;this.$1Bq=u;this.$Bq=e;this.$CY=s;this.$l=h};_at.$19o.prototype={$PD:null,$n:null,$2Y:null,$1D:null,$Mm:null,$1Bq:null,$l:null,$Bq:null,$CY:null,$9:function(n,t,i,r,u,f){return new _at.$yA(n,t,i,r,u,f,this.$PD,this.$n,this.$2Y,this.$1D,this.$1Bq,this.$Bq,this.$Mm,this.$CY,this.$l)}};_at.$1Et=function(n){this.$2D=n;this.$3Kj={};this.$24O=new(_ff.$18.$$(_at.$PI))};_at.$1Et.prototype={$2D:null,$3Kj:null,$24O:null,get_$A:function(){return this.$24O.get_$A()},$5l:function(n){_a.$4.$1s(n,"attachmentId");return n in this.$3Kj},$F:function(n){this.$5qh(n);if(!this.$5l(n.$D3)){this.$3fC("FastLookupQueue. Adding {0}",n);this.$24O.$F(n);this.$3Kj[n.$D3]=""}},$6i:function(n,t){this.$5qh(t);if(!this.$5l(t.$D3)){this.$3fC("FastLookupQueue. InsertAt {0}",t);this.$24O.$1EZ(n,t);this.$3Kj[t.$D3]=""}},$AVh:function(){this.$3fC("FastLookupQueue. DeQueue. Current count {0}",this.get_$A());if(this.get_$A()>0){var n=this.$24O.get_$E(0);this.$3M(n);return n}else return null},$3M:function(n){this.$5qh(n);this.$3fC("FastLookupQueue. Remove. Current count {0}",this.get_$A());if(this.$5l(n.$D3)){this.$3fC("FastLookupQueue. Remove. Found {0}",n);delete this.$3Kj[n.$D3];for(var i=-1,t=0;t<this.$24O.get_$A();t++)if(this.$24O.get_$E(t).$D3===n.$D3){i=t;break}if(i!==-1){this.$24O.$5W(i);this.$3fC("FastLookupQueue. Returning from remove after removal. Current Count {0}",this.get_$A())}}},$5qh:function(n){_a.$4.$X(n,"parameter");_a.$4.$X(n.$D3,"AttachmentId")},$3fC:function(n,t){}};_at.$Ae=function(){};_at.$Ae.$6qo=function(n,t,i,r,u,f,e){_a.$4.$X(n,"initNativeBridge");_a.$4.$X(t,"initClientStore");_a.$4.$X(i,"initAttachmentInfoRecord");_a.$4.$1s(r,"initMimeType");_a.$4.$1s(u,"fileName");_a.$4.$X(f,"initOnOpenAttachmentSuccess");_a.$4.$X(e,"initOnOpenAttachmentError");if(_at.$Ae.$4xE){_js.Trace.logInfo(_at.$Ae.$L,"Already opening an attachment so returning.");return}_js.Trace.logInfo(_at.$Ae.$L,"OpenAttachment with record DataID {0}, Size {1}, id {2}",i.AttachmentId,i.DataID,i.Size);_at.$Ae.$4xE=!0;n.get_$IF().$DnJ(i.DataID,r,u,function(n){_at.$Ae.$DeV(n,i,t,f,e)});t.$8DB(i.AttachmentId,function(n){},null)};_at.$Ae.$Bmy=function(n){var t=null;switch(n){case 0:break;case 1:case 3:t=_nbs.NonBootStrings.l_UnableToFindActivity_Text;break;case 2:t=_nbs.NonBootStrings.l_DownloadAttachmentAgain_Text;break;default:break}_js.Trace.logInfo(_at.$Ae.$L,"OpenPalAttachment error code {0}, string: {1}",n,t);return t};_at.$Ae.$DeV=function(n,t,i,r,u){_at.$Ae.$4xE=!1;var f=!0;switch(n){case 0:f=!1;break;case 1:case 3:break;case 2:i.$7kI(t.AttachmentId);break;default:break}if(f){_js.Trace.logWarning(_at.$Ae.$L,"OnOpenDocument failed with errorCode {0}",n);u(n)}else{_js.Trace.logInfo(_at.$Ae.$L,"OnOpenDocument succeeded");r()}};_at.$4Z=function(n,t,i){this.$$d_$DWW=Function.createDelegate(this,this.$DWW);this.$$d_$Ddb=Function.createDelegate(this,this.$Ddb);this.$$d_$9C2=Function.createDelegate(this,this.$9C2);_a.$4.$X(n,"initNativeBridge");var r=t?t.get_$4Ip():null;this.$l=n;this.$4VI=i;this.$43=n.get_$6sK().$6SE(r);this.$3e(t)};_at.$4Z.prototype={$43:!1,$1Jb:null,$UU:null,$1aV:null,$3l3:0,$2gY:null,$l:null,$4VI:null,$9j:null,get_$1QE:function(){if(!this.$43&&_g.$1H.$1Q){var n=_bc.$Og.isInstanceOfType(_g.$1H.$1Q)?_g.$1H.$1Q:null;this.$43=this.$l.get_$6sK().$6SE(n?n.get_$9w():null);this.$3e(n?n.get_$4R().get_$2E6():null)}return this.$43},$1k:function(n,t){_a.$4.$1s(n,"attachmentId");_a.$4.$X(t,"callbacks");if(this.get_$1QE()){this.$2gY[n]=t;this.$AqQ(n,t)}else _js.Trace.logInfo(_at.$4Z.$L,"PAL does not support download.")},$2bN:function(n){_a.$4.$1s(n,"attachmentId");this.get_$1QE()&&n in this.$2gY&&delete this.$2gY[n]},$4bk:function(n){_a.$4.$X(n,"parameters");_a.$4.$X(n.$D3,"AttachmentId");_a.$4.$X(n.$Y0,"DownloadUrl");_js.Trace.logInfo(_at.$4Z.$L,"DownloadAttachment:Begin download Attachment for parameters {0}",n);if(this.get_$1QE()){if(!(n.$D3 in this.$2gY))throw Error.invalidOperation("Subscribe must be called before calling DownloadAttachment.");var t=this.$Ebb(n);if(_js.$9.$o(t)){if((!this.$UU||this.$UU.$D3!==n.$D3)&&!this.$1Jb.$5l(n.$D3)){_js.Trace.logInfo(_at.$4Z.$L,"Starting download for {0}",n);if(n.$6Qt){this.$1Jb.$6i(0,n);if(this.$UU){this.$7Zs();this.$1Jb.$6i(1,this.$1aV);this.$2VI(this.$1aV,2)}else{this.$2VI(n,2);this.$5a9()}}else{this.$1Jb.$F(n);this.$2VI(n,2);this.$5a9()}}}else this.$6wb(n,t)}},$Gg:function(n){_a.$4.$X(n,"parameters");_a.$4.$X(n.$D3,"AttachmentId");_js.Trace.logInfo(_at.$4Z.$L,"Cancel download for parameters {0}",n);if(this.get_$1QE())if(this.$1Jb.$5l(n.$D3)){this.$1Jb.$3M(n);_js.Trace.logInfo(_at.$4Z.$L,"Found and removed from queue {0}. Pending Items in queue {1}",n,this.$1Jb.get_$A());this.$2VI(n,1)}else if(this.$UU&&this.$UU.$D3===n.$D3){_js.Trace.logInfo(_at.$4Z.$L,"Current Download was canceled. {0}",this.$UU);this.$7Zs();this.$2VI(this.$1aV,1)}},$Bxv:function(n){var t=null;switch(n){case 0:break;case 7:break;case 3:t=_nbs.NonBootStrings.l_SpeechInvalidCredentials_Text;break;case 8:break;case 1:case 4:var r=this,i=this;this.$4VI.$AFd(this.$9j,this.$l,function(){_js.Trace.logInfo(_at.$4Z.$L,"Successfully completed CleanAllPalAttachmentInfoAndAttachments")},function(n){_js.Trace.logWarning(_at.$4Z.$L,"CleanAllPalAttachmentInfoAndAttachments failed due to error {0}",n)});t=_nbs.NonBootStrings.l_SpeechServerBusy_Text;break;case 5:t=_nbs.NonBootStrings.l_SpeechNoNetworkAction_Text;break;case 6:t=_nbs.NonBootStrings.l_SpeechServerBusy_Text;break;case 9:t=_nbs.NonBootStrings.l_UnableToDownload_Text;break;case 2:t=_nbs.NonBootStrings.l_UnknownDataIDType_Text;break;default:break}return t},$3e:function(n){if(this.$43){this.$9j=n;this.$1Jb=new _at.$1Et(_at.$4Z.$L);this.$2gY={};this.$1aV=null;this.$UU=null;this.$3l3=0}},$7Zs:function(){_js.Trace.logInfo(_at.$4Z.$L,"CancelCurrentDownload, canceling the current download");this.$l.get_$1rd().$AD7();this.$1aV=this.$UU;this.$UU=null},$5a9:function(){_js.Trace.logInfo(_at.$4Z.$L,"Inside StartDownloadInternal");if(this.$1aV)_js.Trace.logInfo(_at.$4Z.$L,"Still waiting for the canceled download to get canceled.");else if(this.$UU)_js.Trace.logInfo(_at.$4Z.$L,"Still waiting for the current download to finish.");else{_js.Trace.logInfo(_at.$4Z.$L,"StartDownloadInternal, pending items in queue {0}",this.$1Jb.get_$A());this.$UU=this.$1Jb.$AVh();this.$3l3=0;if(this.$UU){_js.Trace.logInfo(_at.$4Z.$L,"Starting download {0}",this.$UU);this.$2VI(this.$UU,3);var n=this;this.$4VI.$EjX(this.$9j,this.$l,this.$$d_$9C2,function(t){_js.Trace.logWarning(_at.$4Z.$L,"Scheduled cleanup failed due to error {0}",t);n.$9C2()})}else _js.Trace.logInfo(_at.$4Z.$L,"Download queue is empty.")}},$9C2:function(){_js.Trace.logInfo(_at.$4Z.$L,"Starting the download now for {0}",this.$UU);if(this.$1aV){this.$1aV=null;this.$5a9()}else this.$l.get_$1rd().$AYe(this.$UU.$Y0,1,this.$UU.$1Js,this.$UU.$2SP,this.$$d_$Ddb,this.$$d_$DWW)},$Ddb:function(n){if(this.$UU){this.$3l3+=n;var t=this;this.$4eX(this.$UU,function(n){n.$97X(t.$3l3)})}},$2VI:function(n,t){var i=this;this.$4eX(n,function(n){n.$2sE(t)})},$6wb:function(n,t){var i=this;this.$4eX(n,function(i){_js.Trace.logWarning(_at.$4Z.$L,"Raising OnError event with error {0} for attachment {1}",t,n);i.$XN(t)})},$4eX:function(n,t){var i=this.$2gY[n.$D3];i&&t(i)},$DWW:function(n,t,i){_js.Trace.logInfo(_at.$4Z.$L,"OnDownloadComplete with errorCode = {0} httpStatusCode = {1} dataID = {2} for attachment {3}",n,t,i,this.$UU);if(this.$1aV)this.$1aV=null;else if(n||t!==200){var f=this.$Bxv(n);_js.$9.$o(f)||this.$6wb(this.$UU,f);this.$2VI(this.$UU,1)}else{var r=this.$UU;var u=new AttachmentInfoRecord(this.$UU.$D3,i,this.$UU.$4S7,_a.$8.get_utcNow().$8a(),this.$UU.$5HQ,0,_a.$8.$Atw(_a.$8.get_utcNow()),!0);var e=this,s=this;this.$9j.$9Q9(u,function(n){_js.Trace.logInfo(_at.$4Z.$L,"Successfully saved attachment in DB with dataID {0} and parameters {1}",i,r)},function(n){_js.Trace.logWarning(_at.$4Z.$L,"Unable to save the attachment in DB with parameters {0} error {1}",r,n)});this.$2VI(r,4);var o=this;this.$4eX(r,function(n){_js.Trace.logInfo(_at.$4Z.$L,"Raising OnAttachmentInfoRecordAvailable with record {0} for attachment {1}",u,r);n.$966(u)})}this.$UU=null;this.$5a9()},$Ebb:function(n){var t=null;if(_bc.$9F.$8T2(n.$D3)){_js.Trace.logInfo(_at.$4Z.$L,"The attachment is not uploaded to the server yet. {0}",n);t=_nbs.NonBootStrings.l_AttachmentOfflineViewingUnsupported_Text}else if(_js.$9.$o(n.$5HQ)){_js.Trace.logInfo(_at.$4Z.$L,"Attachment is a quick message {0}",n);t=_nbs.NonBootStrings.l_AttachmentOfflineViewingUnsupported_Text}else if(_js.$9.$o(n.$2SP)){_js.Trace.logInfo(_at.$4Z.$L,"Attachment does not have content type set. {0}",n);t=_nbs.NonBootStrings.l_UnknownDataIDType_Text}else if(_js.$9.$o(n.$1Js)){_js.Trace.logInfo(_at.$4Z.$L,"Attachment does not have a valid file name {0}.",n);t=_nbs.NonBootStrings.l_UnknownDataIDType_Text}else if(this.$1Jb.get_$A()===10){_js.Trace.logInfo(_at.$4Z.$L,"download queue max size reached. Rejecting attachment with params {0}.",n);t=String.format(_nbs.NonBootStrings.l_DownloadAttachmentQueueMaxSizeReached_Text,10)}return t},$AqQ:function(n,t){if(this.$UU&&n===this.$UU.$D3){_js.Trace.logInfo(_at.$4Z.$L,"FindStatusAndFireCallback. currently downloading attachment with id {0}",n);t.$2sE(3)}else if(this.$1Jb.$5l(n)){_js.Trace.logInfo(_at.$4Z.$L,"FindStatusAndFireCallback. Found in the queue. attachment with id {0}",n);t.$2sE(2)}else{var r=this,i=this;this.$9j.$9PQ(n,function(i){if(i){_js.Trace.logInfo(_at.$4Z.$L,"FindStatusAndFireCallback Found the record in db {0} and AttachmentId {1}",i.DataID,i.AttachmentId);t.$2sE(4);t.$966(i)}else{_js.Trace.logInfo(_at.$4Z.$L,"FindStatusAndFireCallback. Did not find attachment with id {0} in the db.",n);t.$2sE(1)}},function(i){_js.Trace.logWarning(_at.$4Z.$L,"FindStatusAndFireCallback. Got error {0} from DB while retreiving record with id {1}",i,n);t.$2sE(1)})}}};_at.$PI=function(){};_at.$PI.$APd=function(n){_a.$4.$X(n,"viewModel");_a.$4.$X(n.$Y0,"DownloadUrl should not be empty");var t=null;n.$9h&&n.$9h.get_$F7()&&(t=n.$9h.get_$F7().Id);return _at.$PI.$7hk(n.$1w,n.$1w.get_$1x(),n.$1w.get_$KN(),n.$Y0,t,!1)};_at.$PI.$7hk=function(n,t,i,r,u,f){_a.$4.$X(n,"attachment");_a.$4.$X(n.get_$6J(),"attachmentId");_a.$4.$X(r,"downloadUrl");_a.$4.$X(r,"destinationFileName");var e=new _at.$PI;e.$D3=n.get_$6J().Id;e.$4S7=n.get_$8D();e.$1Cx=t;e.$1Js=_a.$69.$li(e.$1Cx);e.$2SP=i;e.$Y0=_a.Uri.$2uY(r);e.$5HQ=u;e.$6Qt=f;_js.$9.$o(e.$2SP)&&!_a.UserAgent.getInstance().$YL&&(e.$2SP="fakeMimeType");return e};_at.$PI.prototype={$2SP:null,$1Cx:null,$1Js:null,$D3:null,$5HQ:null,$Y0:null,$4S7:0,$6Qt:!1,toString:function(){return String.format("Attachment with Name {0} Size {1} ContentType {2} AttachmentId{3}",this.$1Cx,this.$4S7,this.$2SP,this.$D3)}};_at.$34=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w){_at.$34.initializeBase(this,[n,t,i,r,u,e,s,h,c,a,v,y,p,w,o]);_a.$4.$z(f,"palDownloadManager");_a.$4.$z(o,"nativeBridge");_a.$4.$z(l,"itemStoreGetter");this.$sd=f;this.$l=o;this.$1e3=l;this.$Mm=p;this.$1w&&this.$9oc(null,this.$1w.get_$6J())};_at.$34.prototype={$l:null,$sd:null,$Mm:null,$1e3:null,$5mb:null,$2sc:0,$48y:null,set_$6sJ:function(n){this.$2sc=n;this.$4("PALAttachmentDownloadStatus");return n},set_$Doj:function(n){this.$48y=n;this.$4("PALAttachmentCurrentDowloadedBytes");return n},get_$95b:function(){return _at.$1j.prototype.get_$95b.call(this)||_g.$54.isInstanceOfType(this.$1w)&&_a.$RV.isInstanceOfType(this.$1w.$LJ)},get_$33m:function(){var n=_at.$1j.prototype.get_$33m.call(this);if(n&&this.$l&&this.$l.$8G(this.$l.get_$IF())){var t=this.$l.$2t(_a.$117,2);_js.Trace.logInfo(_at.$34.$L,"SetOneTimeAllowedUrlSupported is {0}",t);n=!!(n&t)}return n},get_$9Es:function(){return this.$1E.get_$8b()&&this.$7u},get_$7DO:function(){return this.get_$33m()&&!this.get_$4Gq()?!1:this.$sd.get_$1QE()&&this.$7u},get_$pg:function(){return!this.$PG.$1RC||this.$sd.get_$1QE()||this.$PG.$3A7||this.$1w.get_$X8()?!0:!1},$7ML:function(){this.$Esn()},$2sE:function(n){_js.Trace.logInfo(_at.$34.$L,"Got attachment status {0}",n);this.set_$6sJ(n)},$97X:function(n){this.set_$Doj(String.format(_nbs.NonBootStrings.l_DownloadAttachmentProgress_Text,this.$7f6(n,1),this.$7f6(this.$1w.get_$8D(),0)))},$XN:function(n){_js.Trace.logWarning(_at.$34.$L,"Unable to download attachment with name {0} and error is {1}",this.$1w.get_$1x(),n);this.$44(n)},$966:function(n){_js.Trace.logInfo(_at.$34.$L,"Found/Saved the record in offline db {0} {1}",n.DataID,n.AttachmentId);this.$5mb=n},$9wt:function(n){_a.$RV.isInstanceOfType(n.$LJ)?n.get_$CA()?this.$7Gp():this.$9ww():_at.$1j.prototype.$9wt.call(this,n)},$7kT:function(n){if(_a.$RV.isInstanceOfType(n.$LJ)){_js.Trace.logInfo(_at.$34.$L,"Deleting file attachment via PAL.");var t=n.$LJ;this.$l.get_$2g().$1ko(t.get_$1yt())}else _at.$1j.prototype.$7kT.call(this,n)},$6qo:function(){if(this.$sd.get_$1QE()){_js.Trace.logInfo(_at.$34.$L,"Will use PAL to open attachment.");this.$DnD()}else _at.$1j.prototype.$6qo.call(this)},$965:function(n,t){this.$9oc(n,t);_at.$1j.prototype.$965.call(this,n,t)},$DnD:function(){_js.Trace.logInfo(_at.$34.$L,"OpenAttachmentUsingPAL, download status={0}",this.$2sc);if(!this.$9h.$3yk(this.$99)){_js.Trace.logWarning(_at.$34.$L,"The context has changed from "+this.$99+" to "+this.$9h.get_$1ao()+", opening attachment using PAL has been skipped.");return}if(this.$9h.get_$6PY()||!this.$7u){_js.Trace.logInfo(_at.$34.$L,"Returning because the attachment is a fake message. IsComposeReadOnlyWell = {0} and IsReadOnly {1}",this.$9h.get_$6PY(),this.$7u);return}this.$EwW();var t=_at.$PI.$APd(this);_js.Trace.logInfo(_at.$34.$L,"PAL attachment download parameters: {0}",t.toString());switch(this.$2sc){case 0:case 1:this.$97X(0);_js.Trace.logInfo(_at.$34.$L,"Starting PAL attachment download.");this.$sd.$4bk(t);break;case 3:case 2:_js.Trace.logInfo(_at.$34.$L,"Canceling PAL attachment download.");this.$sd.$Gg(t);break;case 4:_js.Trace.logInfo(_at.$34.$L,"PAL attachment download complete.");var n=this;this.$1e3.$9(function(){var i=n.$1e3.get_$1Z().$9(_g.$O.get_$Q().get_$1j().get_$HM());_at.$Ae.$6qo(n.$l,i.get_$2E6(),n.$5mb,t.$2SP,t.$1Cx,function(){_js.Trace.logInfo(_at.$34.$L,"Attachment opened successfully.")},function(t){_js.Trace.logWarning(_at.$34.$L,"Attachment open failed with errorCode {0}",t);t===2&&n.set_$6sJ(1);var i=_at.$Ae.$Bmy(t);n.$44(i)})});break;default:break}},$9oc:function(n,t){if(this.$sd)if(_g.$7d.isInstanceOfType(this.$1w)){_js.Trace.logInfo(_at.$34.$L,"ItemAttachment for PAL status:Downloaded");this.set_$6sJ(4)}else if(this.$sd.get_$1QE()){!$C(n)&&n.Id&&this.$sd.$2bN(n.Id);!$C(t)&&t.Id&&this.$sd.$1k(t.Id,this)}},$Esn:function(){if(this.$sd.get_$1QE()&&this.$1w&&this.$1w.get_$6J()&&!_g.$7d.isInstanceOfType(this.$1w)){_js.Trace.logInfo(_at.$34.$L,"Unsubscribing for attachment with name {0} and id {1}",this.$1w.get_$1x(),this.$1w.get_$6J());this.$sd.$2bN(this.$1w.get_$6J().Id)}},$7f6:function(n,t){var i;var r=n;if(n>=1073741824){r/=1073741824;i=_u.Strings.l_SizeWithGigabyteAbbreviation_Text}else if(n>=1048576){r/=1048576;i=_u.Strings.l_SizeWithMegabyteAbbreviation_Text}else if(n>=1024){r/=1024;i=_u.Strings.l_SizeWithKilobyteAbbreviation_Text}else i=_u.Strings.l_SizeWithByteAbbreviation_Text;return String.format(i,Math.round(r*Math.pow(10,t))/Math.pow(10,t))},$EwW:function(){if(this.$1E.get_$fP()&&(_js.$9.$1h(this.$1w.get_$KN())||_at.$34.$4gJ===this.$1w.get_$KN().toLowerCase())){var t=_a.$69.$li(this.$1w.get_$1x());var n;if(_js.$9.$1h(t))n=_at.$34.$4gJ;else{n=_at.$34.$7pe[t.toLowerCase()];_js.$9.$o(n)&&(n=_at.$34.$4gJ)}_js.Trace.logInfo(_at.$34.$L,"PAL GetMimeType File(Name:'{0}', Ext='{1}'), MimeType:(original:'{2}' is replaced with:'{3}')",this.$1w.get_$1x()||"<NULL>",t||"<NULL>",this.$1w.get_$KN()||"<NULL>",n);this.$1w.set_$KN(n)}}};_at.$1Pd=function(){};_at.$1Pd.prototype={get_$1QE:function(){return!1},$1k:function(n,t){throw Error.invalidOperation("This method is not implemented for BOWA.");},$2bN:function(n){throw Error.invalidOperation("This method is not implemented for BOWA.");},$4bk:function(n){throw Error.invalidOperation("This method is not implemented for BOWA.");},$Gg:function(n){throw Error.invalidOperation("This method is not implemented for BOWA.");}};var IWellKnownFileTypes=function(){};IWellKnownFileTypes.registerInterface("IWellKnownFileTypes");_at.$jC=function(){};_at.$jC.prototype={$4L:function(n,t){return String.format(_nbs.NonBootStrings.l_AttachmentParenthesisFormat_Text,n)},$7en:function(n,t){throw Error.notImplemented();}};_at.$1EG=function(){};_at.$1EG.prototype={};_at.$1EG.registerEnum("_at.$1EG",!1);_at.$1Aw=function(){};_at.$1Aw.prototype={$4L:function(n,t){var r=n;var i=_js.$1I.$1GQ(_a.$C4,t.toString());return r!==i},$7en:function(n,t){throw Error.notImplemented();}};_at.$r7=function(){};_at.$r7.prototype={$4L:function(n,t){var i=n;return!i||!i.$1w?"":i.get_$HO()!==1&&i.get_$HO()!==2?"":_js.$9.$o(i.$1w.get_$5c7())?i.get_$vD():"data:"+i.$1w.get_$9qH()+";base64,"+i.$1w.get_$5c7()},$7en:function(n,t){throw Error.notImplemented();}};_at.$vv=function(){};_at.$vv.prototype={$4L:function(n,t){var i=n;var r=!0;try{var u=_js.$1I.$1GQ(_at.$1EG,t.toString());switch(u){case 1:i&&i!==1||(r=!1);break;case 2:i&&i!==1&&i!==4||(r=!1);break;case 3:i===3&&(r=!1);break;case 4:(i===3||i===2)&&(r=!1);break;case 5:i===2&&(r=!1);break;case 6:i!==1&&i||(r=!1);break}}catch(f){r=!0}return r},$7en:function(n,t){throw Error.notImplemented();}};_at.$1D8.registerClass("_at.$1D8",_h.$1A3.$$(String));AttachmentsComponent.registerClass("AttachmentsComponent",null,_a.$1X7);_at.$4v.registerClass("_at.$4v",_b.$G5);_at.$64.registerClass("_at.$64");_at.$1B6.registerClass("_at.$1B6");_at.$sv.registerClass("_at.$sv",null,_at.$1VO);_at.$11n.registerClass("_at.$11n");_at.$1CI.registerClass("_at.$1CI",_h.$1A3.$$(Boolean),_a.$13Q);_at.$Cu.registerClass("_at.$Cu",_h.$TS.$$(_g.$Lz,_g.$ZH));_at.$1DA.registerClass("_at.$1DA",_at.$Cu);_at.$1Dg.registerClass("_at.$1Dg",_h.$TS.$$(_g.$Qp,_g.$an));_at.$V0.registerClass("_at.$V0",_h.$TS.$$(_g.$V1,_g.$ZH));_at.$1Fd.registerClass("_at.$1Fd",_h.$1A3.$$(String));_at.$AS.registerClass("_at.$AS");_at.$r4.registerClass("_at.$r4",_a.$AY);_at.$GS.registerClass("_at.$GS");_at.$1j.registerClass("_at.$1j",_a.$En,_y.$OU,_js.$13p);_at.$1BA.registerClass("_at.$1BA",null,IAttachmentViewModelFactory);_at.$TP.registerClass("_at.$TP");_at.$6b.registerClass("_at.$6b");_at.$Uj.registerClass("_at.$Uj",_at.$1j);_at.$yA.registerClass("_at.$yA",_at.$Uj);_at.$19o.registerClass("_at.$19o",null,IUriFileAttachmentViewModelFactory);_at.$1Et.registerClass("_at.$1Et");_at.$Ae.registerClass("_at.$Ae");_at.$4Z.registerClass("_at.$4Z",null,_at.$Vp);_at.$PI.registerClass("_at.$PI");_at.$34.registerClass("_at.$34",_at.$1j,_at.$1VM);_at.$1Pd.registerClass("_at.$1Pd",null,_at.$Vp);_at.$jC.registerClass("_at.$jC",null,_js.$1KJ);_at.$1Aw.registerClass("_at.$1Aw",null,_js.$1KJ);_at.$r7.registerClass("_at.$r7",null,_js.$1KJ);_at.$vv.registerClass("_at.$vv",null,_js.$1KJ);_at.$4v.$5mf=new _H("Attachment",_g.Attachment,_at.$4v);_at.$4v.$6sW=new _H("ParentItemId",_g.$1T,_at.$4v);_at.$4v.$2No=new _H("IsEnabled",Boolean,_at.$4v);_at.$4v.$637=new _H("FileSelectedCommand",_js.$Ct,_at.$4v);_at.$4v.$5fg=new _H("UploadAttachmentCommand",_js.$Ct,_at.$4v);_at.$4v.$7Ny=new _H("UploadCompletedCommand",_js.$Ct,_at.$4v);_at.$4v.$L=_a.$0.$1m;_at.$64.$1Q=null;_at.$Cu.$L=_a.$0.$1m;_at.$V0.$L=_a.$0.$1m;_at.$AS.$4qs=null;_at.$GS.$3hd=null;_at.$GS.$$cctor();_at.$1j.$L=_a.$0.$1m;_at.$6b.$635=["","NOT_FOUND_ERR","SECURITY_ERR","ABORT_ERR","NOT_READABLE_ERR","ENCODING_ERR","NO_MODIFICATION_ALLOWED_ERR","INVALID_STATE_ERR","SYNTAX_ERR","INVALID_MODIFICATION_ERR","QUOTA_EXCEEDED_ERR","TYPE_MISMATCH_ERR","PATH_EXISTS_ERR"];_at.$Ae.$L=_a.$0.$1m;_at.$Ae.$4xE=!1;_at.$4Z.$L=_a.$0.$1m;_at.$34.$L=_a.$0.$1m;_at.$34.$4gJ="application/octet-stream";_at.$34.$1Mm="application/vnd.ms-excel";_at.$34.$6lq="application/msword";_at.$34.$2r5="application/vnd.ms-powerpoint";_at.$34.$7pe={".abc":"text/vnd.abc",".acgi":"text/html",".afl":"video/animaflex",".aif":"audio/aiff",".aifc":"audio/aiff",".aiff":"audio/aiff",".aip":"text/x-audiosoft-intra",".art":"image/x-jg",".asf":"video/x-ms-asf",".asm":"text/x-asm",".asp":"text/asp",".asx":"video/x-ms-asf",".au":"audio/basic",".avi":"video/avi",".avs":"video/avs-video",".bm":"image/bmp",".bmp":"image/bmp",".c":"text/plain",".c++":"text/plain",".cat":"application/vnd.ms-pki.seccat",".cc":"text/plain",".chm":"application/vnd.ms-htmlhelp",".conf":"text/plain",".cpp":"text/x-c",".cs":"text/plain",".css":"text/css",".csv":_at.$34.$1Mm,".cxx":"text/plain",".def":"text/plain",".dif":"video/x-dv",".dl":"video/dl",".doc":_at.$34.$6lq,".docm":"application/vnd.ms-word.document.macroEnabled.12",".docx":"application/vnd.openxmlformats-officedocument.wordprocessingml.document",".dot":_at.$34.$6lq,".dotm":"application/vnd.ms-word.template.macroEnabled.12",".dotx":"application/vnd.openxmlformats-officedocument.wordprocessingml.template",".dv":"video/x-dv",".dwg":"image/vnd.dwg",".dxf":"image/vnd.dwg",".el":"text/x-script.elisp",".etx":"text/x-setext",".f":"text/plain",".f77":"text/x-fortran",".f90":"text/plain",".fif":"image/fif",".fli":"video/fli",".flo":"image/florian",".flx":"text/vnd.fmi.flexstor",".fmf":"video/x-atomic3d-feature",".for":"text/x-fortran",".fpx":"image/vnd.fpx",".funk":"audio/make",".g":"text/plain",".g3":"image/g3fax",".gif":"image/gif",".gl":"video/gl",".gsd":"audio/x-gsm",".gsm":"audio/x-gsm",".h":"text/plain",".hh":"text/plain",".hlb":"text/x-script",".htc":"text/x-component",".htm":"text/html",".html":"text/html",".htmls":"text/html",".htt":"text/webviewhtml",".htx":"text/html",".hxx":"text/plain",".ico":"image/x-icon",".idc":"text/plain",".ief":"image/ief",".iefs":"image/ief",".isu":"video/x-isvideo",".it":"audio/it",".jam":"audio/x-jam",".jav":"text/plain",".java":"text/plain",".jfif":"image/jpeg",".jfif-tbnl":"image/jpeg",".jpe":"image/jpeg",".jpeg":"image/jpeg",".jpg":"image/jpeg",".jps":"image/x-jps",".jut":"image/jutvision",".kar":"audio/midi",".la":"audio/nspaudio",".lam":"audio/x-liveaudio",".list":"text/plain",".lma":"audio/nspaudio",".log":"text/plain",".lst":"text/plain",".lsx":"text/x-la-asf",".m":"text/plain",".m1v":"video/mpeg",".m2a":"audio/mpeg",".m2v":"video/mpeg",".m3u":"audio/x-mpequrl",".mar":"text/plain",".mcf":"text/mcf",".mid":"audio/midi",".midi":"audio/midi",".mjf":"audio/x-vnd.audioexplosion.mjuicemediafile",".mjpg":"video/x-motion-jpeg",".mod":"audio/mod",".moov":"video/quicktime",".mov":"video/quicktime",".movie":"video/x-sgi-movie",".mp2":"audio/mpeg",".mp3":"audio/mpeg",".mp4":"video/mp4",".mpa":"audio/mpeg",".mpe":"video/mpeg",".mpeg":"video/mpeg",".mpg":"video/mpeg",".mpga":"audio/mpeg",".mpp":"application/vnd.ms-project",".mpt":"application/vnd.ms-project",".mpv":"application/vnd.ms-project",".mpx":"application/vnd.ms-project",".mv":"video/x-sgi-movie",".my":"audio/make",".nap":"image/naplps",".naplps":"image/naplps",".nif":"image/x-niff",".niff":"image/x-niff",".ogg":"video/ogg",".ogv":"video/ogg",".p":"text/x-pascal",".pas":"text/pascal",".pbm":"image/x-portable-bitmap",".pct":"image/x-pict",".pcx":"image/x-pcx",".pdf":"application/pdf",".pfunk":"audio/make",".pgm":"image/x-portable-greymap",".pic":"image/pict",".pict":"image/pict",".pko":"application/vnd.ms-pki.pko",".pl":"text/plain",".pm":"image/x-xpixmap",".png":"image/png",".pot":_at.$34.$2r5,".potm":"application/vnd.ms-powerpoint.template.macroEnabled.12",".potx":"application/vnd.openxmlformats-officedocument.presentationml.template",".ppa":_at.$34.$2r5,".ppam":"application/vnd.ms-powerpoint.addin.macroEnabled.12",".ppm":"image/x-portable-pixmap",".pps":_at.$34.$2r5,".ppsm":"application/vnd.ms-powerpoint.slideshow.macroEnabled.12",".ppsx":"application/vnd.openxmlformats-officedocument.presentationml.slideshow",".ppt":_at.$34.$2r5,".pptm":"application/vnd.ms-powerpoint.presentation.macroEnabled.12",".pptx":"application/vnd.openxmlformats-officedocument.presentationml.presentation",".ppz":_at.$34.$2r5,".pwz":_at.$34.$2r5,".py":"text/x-script.phyton",".qcp":"audio/vnd.qcelp",".qif":"image/x-quicktime",".qt":"video/quicktime",".qtc":"video/x-qtc",".qti":"image/x-quicktime",".qtif":"image/x-quicktime",".ra":"audio/x-pn-realaudio",".ram":"audio/x-pn-realaudio",".rast":"image/cmu-raster",".rexx":"text/x-script.rexx",".rf":"image/vnd.rn-realflash",".rgb":"image/x-rgb",".rmi":"audio/mid",".rmm":"audio/x-pn-realaudio",".rmp":"audio/x-pn-realaudio",".rp":"image/vnd.rn-realpix",".rpm":"audio/x-pn-realaudio-plugin",".rt":"text/richtext",".rtf":"text/richtext",".rtx":"text/richtext",".rv":"video/vnd.rn-realvideo",".s":"text/x-asm",".s3m":"audio/s3m",".sdml":"text/plain",".sgm":"text/sgml",".sgml":"text/sgml",".shtml":"text/html",".sid":"audio/x-psid",".sldm":"application/vnd.ms-powerpoint.slide.macroEnabled.12",".sldx":"application/vnd.openxmlformats-officedocument.presentationml.slide",".snd":"audio/basic",".spc":"text/x-speech",".ssi":"text/x-server-parsed-html",".sst":"application/vnd.ms-pki.certstore",".svf":"image/vnd.dwg",".talk":"text/x-speech",".tcsh":"text/x-script.tcsh",".text":"text/plain",".tif":"image/tiff",".tiff":"image/tiff",".tsi":"audio/tsp-audio",".tsv":"text/tab-separated-values",".turbot":"image/florian",".txt":"text/plain",".uil":"text/x-uil",".uni":"text/uri-list",".unis":"text/uri-list",".uri":"text/uri-list",".uris":"text/uri-list",".uue":"text/x-uuencode",".vcs":"text/x-vcalendar",".vdo":"video/vdo",".viv":"video/vivo",".vivo":"video/vivo",".voc":"audio/voc",".vos":"video/vosaic",".vox":"audio/voxware",".vqe":"audio/x-twinvq-plugin",".vqf":"audio/x-twinvq",".vql":"audio/x-twinvq-plugin",".vsd":"application/x-visio",".vst":"application/x-visio",".vsw":"application/x-visio",".w6w":"application/msword",".wav":"audio/wav",".wbmp":"image/vnd.wap.wbmp",".webm":"video/webm",".wiz":"application/msword",".wm":"video/x-ms-wm",".wma":"audio/x-ms-wma",".wmf":"windows/metafile",".wml":"text/vnd.wap.wml",".wmls":"text/vnd.wap.wmlscript",".wmp":"video/x-ms-wmp",".wmv":"video/x-ms-wmv",".wmx":"video/x-ms-wmx",".word":"application/msword",".wsc":"text/scriplet",".wvx":"video/x-ms-wvx",".xbm":"image/x-xbitmap",".xdr":"video/x-amt-demorun",".xif":"image/vnd.xiff",".xl":"application/excel",".xla":_at.$34.$1Mm,".xlam":"application/vnd.ms-excel.addin.macroEnabled.12",".xlb":_at.$34.$1Mm,".xlc":_at.$34.$1Mm,".xld":_at.$34.$1Mm,".xlk":_at.$34.$1Mm,".xll":_at.$34.$1Mm,".xlm":_at.$34.$1Mm,".xls":_at.$34.$1Mm,".xlsb":"application/vnd.ms-excel.sheet.binary.macroEnabled.12",".xlsm":"application/vnd.ms-excel.sheet.macroEnabled.12",".xlsx":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",".xlt":_at.$34.$1Mm,".xltm":"application/vnd.ms-excel.template.macroEnabled.12",".xltx":"application/vnd.openxmlformats-officedocument.spreadsheetml.template",".xlv":_at.$34.$1Mm,".xlw":_at.$34.$1Mm,".xm":"audio/xm",".xpm":"image/xpm",".xps":"application/vnd.ms-xpsdocument",".x-png":"image/png",".xsr":"video/x-amt-showrun",".xwd":"image/x-xwd",".zsh":"text/x-script.zsh"};
window.scriptsLoaded['microsoft.exchange.clients.owa2.client.core.attachments.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.exchange.clients.owa2.client.core.attachments.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
